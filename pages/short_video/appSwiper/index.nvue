<template>
	<view class="container">
		<!--
		æ³¨æ„ï¼šè¿™æ˜¯ App æ‰€ç”¨é¡µé¢ï¼Œè¯·å‹¿å¼•å…¥å¾®ä¿¡å°ç¨‹åºæˆ–æµè§ˆå™¨è¿è¡Œï¼Œæœ€å¥½è¿è¡Œåœ¨çœŸæœº

		1. new_index.nvueã€index.nvueè¿™ä¸¤ä¸ªæ˜¯Appé¡µé¢

		2. index.nvue - é¡µé¢é¢„åŠ è½½ä½¿ç”¨ - åœ¨çº¿é¢„åŠ è½½æ–¹æ¡ˆ

		3. å¦å¤–ï¼šdata.js æ˜¯ä¸Šä¸€ç‰ˆæœ¬ç•™ä¸‹çš„å‡æ•°æ®ï¼Œè¿™ä¸€ç‰ˆæ”¹æˆäº† URL è¯·æ±‚äº†ï¼ˆå¦‚ä¸éœ€è¦å¯ä»¥åˆ é™¤ï¼Œä¹Ÿå¯ä½œä¸ºåç«¯è¯·æ±‚å‚è€ƒï¼‰

		4. è¯·å„ä½å¤§ç¥å¤šå¤šç•™æ‰‹ï¼Œæˆ‘å·²ç»æŠŠè¯·æ±‚å†…å­˜å¼€åˆ°æœ€å¤§äº†

		5. è§†é¢‘ id åˆ‡è®°æ˜¯å­—ç¬¦ä¸²ç±»å‹

		6. è¿™é‡Œä»… App ç«¯å¼•å…¥äº† App ç«¯ä¸“ç”¨è¯„è®ºï¼Œå°ç¨‹åº ã€H5 å¼•å…¥çš„æ—¶å€™ å¯ä»¥ä½œä¸ºå‚è€ƒ

		ã€
			Appã€å°ç¨‹åºã€H5è¯„è®ºè¯·å‚è€ƒæ’ä»¶ï¼šhttps://ext.dcloud.net.cn/plugin?id=7875
		ã€‘
		 -->
		<!-- å¤´éƒ¨å¯¼èˆª -->
		<view v-if="!isUser" class="header">
			<view class="items" @click.stop="navTap(2)">
				<text class="tName" :class="currentNav==2?'on':''">å…³æ³¨</text>
			</view>
			<view class="items" @click.stop="navTap(1)">
				<text class="tName" :class="currentNav==1?'on':''">æ¨è</text>
			</view>
		</view>
		<view class="noVideo acea-row row-center-wrapper" v-if="!dataList.length && !loadVideo">
			<view>
				<image :src="imgHost+'/static/no-video.png'" class="pictrue"></image>
				<text class="tips">æš‚æ— çŸ­è§†é¢‘å†…å®¹å“¦~</text>
			</view>
		</view>
		<view :style="'width: '+ windowWidth +'px; height: '+ boxStyle.height +'px;'">
			<!--
			 1.è¿™é‡Œçš„ swiper ä¸æ˜¯ç”¨æ¥æ§åˆ¶è§†é¢‘æ»‘åŠ¨çš„ï¼Œè€Œæ˜¯ç”¨æ¥æ§åˆ¶å·¦å³æ»‘åŠ¨çš„ï¼Œå¦‚æœä¸éœ€è¦çš„å¯ä»¥æ”¹æˆ view

			 2.ä¸ºäº† è§†é¢‘æ— é™åŠ è½½ï¼Œå·²ç»æŠŠ 21 è¡Œçš„ appear å»æ‰äº†ï¼ŒåŠ ä¸Šäº† loadmore æ–¹æ³•ï¼ˆç¬¬10è¡Œï¼‰

			 3.ç”±äºæ–¹æ³•æ¯”è¾ƒå¤šï¼Œå¯ä»¥é‡‡å–ä¸‹é¢çš„æ–¹å¼æŸ¥çœ‹ä»£ç ï¼š
			 ï¼ˆ1ï¼‰Macï¼šæŒ‰ä½ option é”®ï¼Œç„¶åç‚¹å‡»æ–¹æ³•åï¼Œå³å¯è·³è½¬åˆ°æ–¹æ³•
			 ï¼ˆ2ï¼‰windowsï¼šæŒ‰ä½ Alt é”®ï¼Œç„¶åé¼ æ ‡å·¦å‡»ï¼Œå³å¯è·³è½¬åˆ°æ–¹æ³•
			 -->
			<list @loadmore="getData" @scroll="scrolls" :loadmoreoffset="wHeight*1" :show-scrollbar="false" ref="listBox" :pagingEnabled="true" :scrollable="true">
				<!-- åˆ·æ–°æ¨¡å— -->
				<refresh class="refresh" @refresh="onrefresh" @pullingdown="onpullingdown" :display="refreshing ? 'show' : 'hide'">
					<loading style="background-color: #FFFFFF;">
						<image :src="`${imgHost}/static/images/logins.gif`" :style="'width: 80upx; height: 40upx; margin-top: 80upx; margin-bottom: 30upx; margin-left: '+ (windowWidth - 200) +'px;'"></image>
					</loading>
				</refresh>
				<!-- å¾ªç¯æ•°æ® -->
				<cell v-for="(item,i) in dataList" :key="i">
					<!-- ç”¨divæŠŠè§†é¢‘æ¨¡ç»„å¥—èµ·æ¥ -->
					<div :style="'width: '+ windowWidth +'px; height: '+ boxStyle.height +'px;'">
						<!-- <view v-if="Math.abs(k-i)<=1"> -->
						<view v-if="max > i">
							<view class="root">
								<!--
								å…·ä½“è§†é¢‘å‚æ•°å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£
								è¯´æ˜ï¼š
								1.v-ifå¾ˆå…³é”®ï¼Œè¿™é‡Œä¸»è¦æ˜¯ä¸ºäº†å‡å°‘ dom å…ƒç´ ã€è¿™æ ·æ‰ä¸ä¼šåŠ è½½è§†é¢‘å¤šäº†é—ªé€€ã€‘ï¼Œ
									è¿™é‡Œ Math.abs(k-i)<=5 ä¹Ÿå°±æ˜¯å¾€ä¸Šé¢„åŠ è½½ 5 ä¸ªè§†é¢‘ï¼Œå¾€ä¸‹é¢„åŠ è½½ 5
									ä¸ªè§†é¢‘è¿™æ ·åšçš„ç›®çš„æ˜¯ä¸ºäº†è®©è§†é¢‘èƒ½å¤Ÿæå‰åŠ è½½ä½†æ˜¯ä¸æ’­æ”¾ï¼Œåœ¨çœŸæ­£æ»‘åˆ°ä½
									ç½®çš„æ—¶å€™æ’­æ”¾è§†é¢‘ã€‚
									ã€2.0.1å°±æ˜¯  1  Math.abs(k-i)<=1ï¼šè¯·å‹¿ä¿®æ”¹ï¼Œè®°ä½ï¼Œè¦ä¸ç„¶ä¼šæå‰æ’­æ”¾å¾ˆå¤šè§†é¢‘ã€‘

								2.è¦æ³¨æ„ @play="playIngs" é‡Œé¢çš„ playIngs æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•åªæ˜¯åœ¨è§†é¢‘æ’­æ”¾çš„æ—¶å€™
									èµ·æ•ˆæœï¼Œæˆ‘ä»¬æ§åˆ¶è§†é¢‘æ’­æ”¾ä¸æ˜¯ç”¨è¿™ä¸ªçš„ã€‚è¿™ä¸ªçš„ä¸»è¦ä½œç”¨æ˜¯ç»™è§†é¢‘å°é¢çš„ã€‚æˆ‘ä»¬å…ˆç”¨
									ä¸‹é¢çš„è§†é¢‘å°é¢ç›–ä½è§†é¢‘ï¼Œç­‰åˆ°è§†é¢‘æ’­æ”¾çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸è¦æ€¥ç€ç›´æ¥æ’­æ”¾ï¼Œè€Œæ˜¯å»¶è¿Ÿä¸€ä¸‹ä¸‹ï¼Œ
									300-600mså·¦å³ã€‚å› ä¸ºè§†é¢‘æ’­æ”¾éœ€è¦ä¸€ç‚¹ç‚¹æ—¶é—´ï¼Œè¿™ç‚¹æ—¶é—´é‡Œä¼šé»‘å±ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±ç”¨
									ä¸‹é¢çš„å°é¢ç›–ä½ï¼Œè¿™æ ·ç”¨æˆ·å°±ä¸ä¼šæœ‰ä»é»‘å±åˆ°æœ‰ç”»é¢çš„æ„Ÿè§‰äº†ï¼Œä½†æ˜¯å¦‚æœé‡åˆ°è§†é¢‘å¤ªå¤§ï¼Œç¼“å†²
									æ—¶é—´å¤ªé•¿ï¼Œè¿˜æ˜¯ä¼šå‡ºç°çŸ­æš‚çš„é»‘å±ï¼Œå¤§éƒ¨åˆ†æ˜¯ä¸ä¼šæœ‰é»‘å±çš„ï¼ˆè¿™æ ·ç›–ä½çš„è¯ï¼‰ã€‚

									ã€æ›´æ–°è®°å½•ï¼š2.0ç‰ˆã€‘å·²ç»è§£å†³äº†è§†é¢‘é»‘å±é—®é¢˜ï¼Œå’ŒåŠ è½½é€Ÿåº¦æ…¢çš„æƒ…å†µï¼Œå¦‚æœè¿˜æ˜¯å‡ºç°äº†é»‘å±ï¼Œ
									æ„å‘³ç€æ­¤æ—¶æ‰‹æ»‘åŠ¨çš„é€Ÿåº¦ï¼Œå·²ç»è¶…è¿‡äº†è§†é¢‘åŠ è½½çš„é€Ÿåº¦ï¼Œå¯¹äºè¿™ä¸ªé—®é¢˜ï¼Œå»ºè®®ä¿®æ”¹ preloadNumber
									å˜é‡ï¼Œå½“å®ƒçš„å€¼å¤§ä¸€ç‚¹çš„æ—¶å€™å°±ä¼šæå‰åŠ è½½è§†é¢‘ï¼Œè¿™æ ·ç”¨æˆ·åœ¨æ»‘åˆ°è§†é¢‘çš„æ—¶å€™å°±ä¸ä¼šæœ‰åœé¡¿æ„Ÿäº†
									ã€æ³¨æ„ã€‘ï¼šè€ç”¨æˆ·åœ¨ video ä¸­å¢åŠ å’Œä¿®æ”¹
									ï¼ˆ1ï¼‰:muted="!item.playIng"ï¼Œ
									ï¼ˆ2ï¼‰@timeupdate="timeupdate($event,i)"
									ï¼ˆ3ï¼‰æŠŠ 199 è¡Œæ³¨é‡Šäº†ï¼Œ
									ï¼ˆ4ï¼‰:id="item.id"ï¼Œ
									ï¼ˆ5ï¼‰ä¿®æ”¹ï¼šuni.createVideoContext(this.dataList[this.k].id + '' + this.k,this) ä¸º
										uni.createVideoContext(this.dataList[this.k].id,this)
									ï¼ˆ6ï¼‰åœ¨ timeupdate æ–¹æ³•é‡ŒåŠ å…¥ï¼Œif(index == this.k){æŠŠé‡Œé¢çš„åŠ ä¸€ä¸ªæ€»çš„åˆ¤æ–­}
								3.å…¶ä»–çš„ä¸‹é¢æœ‰è¯¦è§£
								 -->
								<video
									:ref="'item'+i"
									:id="item.community_id"
									:loop="true"
									:autoplay="i == k"
									:src="item.video_link"
									:muted="item.isplay"
									:enable-progress-gesture="false"
									:page-gesture="false"
									:controls="false"
									:show-loading="true"
									:show-fullscreen-btn="false"
									:show-center-play-btn="false"
									:style="boxStyle"
									:object-fit="object_fit"
									@timeupdate="timeupdate($event,i)"
								></video>
							</view>
							<!-- ç›´æ¥ç”¨ view å°±è¡Œäº†ï¼Œä¸€æ ·æ˜¯å¯ä»¥è¦†ç›–åŸç”Ÿç»„ä»¶çš„ -->
							<!-- è¿™ä¸ªæ˜¯æš‚åœæ—¶å‡ºç°çš„å›¾æ ‡ -->
							<view class="videoHover" @click="tapVideoHover(item.state,$event)" :style="boxStyle">
								<image v-if="item.state=='pause'" class="playState" :src="`${imgHost}/static/images/play.png`"></image>
							</view>
							<!--å®¡æ ¸çŠ¶æ€-->
							<view v-if="item.status==-1 || item.status==0 || item.status==-2" class="video-status">
								<view v-if="item.status == -1 || item.status == -2" class="status-title">
									<image class="image" :src="`${imgHost}/static/images/video-failed.png`"></image>
									<text class="title">{{item.status == -1 ? 'å®¡æ ¸æœªé€šè¿‡' : 'å·²ä¸‹æ¶'}}ï¼Œå†…å®¹ä»…è‡ªå·±å¯è§</text>
								</view>
								<view v-else class="status-title">
									<image class="image" :src="`${imgHost}/static/images/video-review.png`"></image>
									<text class="title">æ­£åœ¨å®¡æ ¸ï¼Œå†…å®¹ä»…è‡ªå·±å¯è§</text>
								</view>
								<view class="status_info">
									<text class="refusal">{{(item.status == -1 || item.status == -2) ? item.refusal : 'å‘å¸ƒçš„å†…å®¹å®¡æ ¸é€šè¿‡åï¼Œå°†åœ¨é¦–é¡µå±•ç¤ºï¼'}}</text>
								</view>
							</view>
							<!-- æœ€åº•ä¸‹çš„æ–‡å­—éƒ¨åˆ† -->
							<view class="content" v-if="dataList.length !== 0">
								<view class="cart">
									<text class="cartName">@{{item.author.nickname}}</text>
								</view>
								<view class="words" :style="'width: '+ (windowWidth - 120) +'px;'">
									<view v-if="item.isMore || item.content.length<=29">
										 <text class="info">{{item.content}}</text>
										 <view class="close">
											 <text v-if="item.isMore" class="more" @click="moreTap(item)">æ”¶èµ·</text>
										 </view>
									</view>
									<view class="wordsCon" v-else>
										<text class="info">{{item.content.slice(0,29)}}...</text>
										<text class="more" @click="moreTap(item)">æ›´å¤š</text>
									</view>
								</view>
								<view v-if="item.relevance.length > 0 && k==i" class="product">
									<scroll-view class="scroll-view" scroll-x="true" style="white-space: nowrap; display: flex;" scroll-with-animation show-scrollbar="true">
										<view class="product-item" v-for="(goods,idx) in item.relevance" :key="idx">
											<view v-if="goods.spu" class="item-count acea-row" @click="goDetail(goods.spu)">
												<view class="picture">
													<image class="image" :src="goods.spu.image"></image>
												</view>
												<view class="product-text">
													<text class="name line1" v-if="goods.spu && goods.spu.store_name.length>=12">{{goods.spu.store_name.slice(0,12)}}...</text>
													<text class="name line1" v-else>{{goods.spu && goods.spu.store_name}}</text>
													<view class="product-price">
														<view class="price"><text class="sm">â‚­</text><text class="money">{{goods.spu.price}}</text></view>
														<text class="buy-btn">è´­ä¹°</text>
													</view>
												</view>
											</view>
										</view>
									</scroll-view>
								</view>
								<navigator v-if="item.topic" hover-class="none" class="product_cate" :url="'/pages/plantGrass/plant_search_list/index?id='+item.topic.topic_id">
									<view class="pro-view">
										<text class="icon">#</text><text class="text">{{item.topic.topic_name}}</text>
									</view>
								</navigator>
							</view>
							<view class="userInfo">
								<!-- 1.å¤´åƒ -->
								<navigator v-if="userInfo.uid != item.author.uid" hover-class="none" :url="'/pages/plantGrass/plant_user/index?id='+item.uid" class="pictrue">
									<image class="userAvatar" :src="item.author.avatar || '/static/images/f.png'" mode="aspectFill"></image>
									<view v-if="!item.is_fans || userInfo.uid == 0" class="guanzhu" @click.stop="followAuthor(item)"><text class="iconfont icon-ic_increase">+</text></view>
									<view v-else class="yiguanzhu"><text class="iconfont"></text></view>
								</navigator>
								<!-- 2.ç‚¹èµ -->
								<view @click="cLike(item);" style="margin-top: 5px;" :class="{'likeNumActive':item.relevance_id}">
									<image v-if="item.relevance_id" :src="`${imgHost}/static/images/xin.png`" style="width: 32px; height: 32px;"></image>
									<image v-if="!item.relevance_id" :src="`${imgHost}/static/images/xin-2.png`" style="width: 32px; height: 32px;"></image>
									<text class="info-text">{{item.count_start > 0 ? item.count_start : 'ç‚¹èµ'}}</text>
								</view>
								<!-- 3.è¯„è®º -->
								<view v-if="community_reply_status == 1 && item.status == 1" class="comment" @click="toComment(item,i)" style="margin-top: 18px;">
									<image :src="`${imgHost}/static/images/evaluate.png`" style="width: 54rpx; height: 50rpx;"></image>
									<text class="info-text">{{item.count_reply>0 ? item.count_reply : 'è¯„è®º'}}</text>
								</view>
								<!-- 4.åˆ†äº« -->
								<view v-if="item.status == 1" @click="appShare('WXSceneSession',item.community_id)" style="margin-top: 17px;">
									<image :src="`${imgHost}/static/images/share-fill.png`" style="width: 40px; height: 40px;"></image>
									<text class="info-text">åˆ†äº«</text>
								</view>
								<!-- 5.è‡ªå·±çš„è§†é¢‘ -->
								<view v-if="userInfo.uid == item.author.uid" style="margin-top: 17px;">
									<view class="video-my" @click="showManage = !showManage">
										<view class="video-dian">
											<text class="dian"></text>
											<text class="dian"></text>
											<text class="dian"></text>
										</view>
									</view>
								</view>
								<!-- æåˆ°çš„å•†å“ -->
								<view v-if="item.relevance.length>0 && k==i" @click="openMore(item)" class="mention" style="opacity: 0.9; margin-top: 18px;">
									<image class="image" :src="`${imgHost}/static/images/collection.png`"></image>
									<text class="count">{{item.relevance.length}}</text>
								</view>
							</view>
							<view v-if="showManage" class="manage">
								<view class="manage-gou"></view>
								<navigator hover-class="none" :url="'/pages/plantGrass/plant_release/index?id='+item.community_id+'&type=2'" class="items">
									<image :src="`${imgHost}/static/images/video-edit.png`" style="width: 16px; height: 16px;"></image>
									<text class="text">ç¼–è¾‘</text>
								</navigator>
								<view class="items" @click.stop="deleteTopic(item)">
									<image :src="`${imgHost}/static/images/video-delete.png`" style="width: 16px; height: 16px;"></image>
									<text class="text">åˆ é™¤</text>
								</view>
							</view>
							<!-- 1.è§†é¢‘é¢„è§ˆæ—¶çš„å›¾ç‰‡ï¼Œcurrenttimesï¼šå°±æ˜¯è·å–å½“å‰æ»‘å—çš„æ—¶é—´ç‚¹ï¼Œå¦‚æœä¸éœ€è¦ï¼Œå¯ä»¥æ³¨é‡Šæ‰ -->
							<!-- 2.å¦‚æœä½¿ç”¨ä¸‹é¢çš„è§†é¢‘é¢„è§ˆçš„è¯è¦æ³¨æ„çš„æ˜¯è§†é¢‘é“¾æ¥æœ€å¥½æ˜¯é˜¿é‡Œäº‘ä¸Šçš„ï¼Œå› ä¸º
									https://xxxxxxxxx.mp4?x-oss-process=video/snapshot,t_1000,f_jpg
									è¿™ä¸ªæ˜¯é˜¿é‡Œäº‘çš„ä¸œè¥¿ï¼Œè‡³äºå…¶ä»–çš„è§†é¢‘æˆªå¸§æˆ‘è¿˜æ²¡æœ‰è¯•è¿‡ã€‚
									-->
							<!-- 3.é˜¿é‡Œäº‘è§†é¢‘æˆªå¸§åœ°å€ï¼šhttps://help.aliyun.com/document_detail/64555.html -->
							<image
							v-if="item.isShowimage == true"
								:src="item.src+'?x-oss-process=video/snapshot,t_'+ currenttimes +'000,f_jpg'"
								mode="aspectFill"
								:style="'width: 120upx; height: 160upx; border-radius: 10upx; position: absolute; bottom: '+ (ProgressBarBottom + 160) +'upx; left: '+ (currentPositions - 15) +'px;'"
							></image>
						</view>
					</div>
				</cell>
			</list>
		</view>
		<!--
		è¯·å‰å¾€ douyin-scrollview.nvue æ–‡ä»¶æŸ¥çœ‹
		å·²ç»å…¨éƒ¨æ³¨é‡Š
		è¿™é‡Œå°±æ˜¯å¼•å…¥è¯„è®ºæ’ä»¶
		-->
		<uni-popup type="bottom" ref="pinglun" @touchmove.stop.prevent="moveHandle">
			<view :style="'width: '+ windowWidth +'px; height: '+ (boxStyle.height/heightNum) +'px; background-color: #fff; border-top-left-radius: 10px; border-top-right-radius: 10px;'">
				<!--
				 æ³¨æ„ï¼š
				 deleteIOSHeight
				 deleteAndroidHeight
				 è¿™ä¸¤ä¸ªå‚æ•°ç”¨äºæ§åˆ¶è¯„è®ºç­‰çš„é«˜åº¦
				 -->
				<douyin-scrollview
				ref="comments"
				:deleteIOSHeight="36"
				:deleteAndroidHeight="15"
				:userInfo="userInfo"
				@closeScrollview="closeScrollview"
				@successFul="pinlunFun"
				></douyin-scrollview>
			</view>
		</uni-popup>
		<!-- ä»–æåˆ°çš„å®è´å¼¹çª— -->
		<uni-popup type="bottom" ref="pinglunMentioned">
			<view :style="'width: '+ windowWidth +'px;background-color: #F5F5F5; border-top-left-radius: 10px; border-top-right-radius: 10px;'">
				<mentioned ref="mentioned" @close="closePopup" :list="moreList" :uid="authorUid"></mentioned>
			</view>
		</uni-popup>
		<view class="fixed-head">
		 	<view class="sys-head" :style="{height:statusBarHeight}"></view>
		 	<view class="tool-bar" @click='goBack()'>
				<image class="icon-ic_leftarrow" :src="`${imgHost}/static/images/icon-back.png`"></image>
		 	</view>
		</view>
	</view>
</template>
<script>
// +----------------------------------------------------------------------
// | CRMEB [ CRMEBèµ‹èƒ½å¼€å‘è€…ï¼ŒåŠ©åŠ›ä¼ä¸šå‘å±• ]
// +----------------------------------------------------------------------
// | Copyright (c) 2016-2026 https://www.crmeb.com All rights reserved.
// +----------------------------------------------------------------------
// | Licensed CRMEBå¹¶ä¸æ˜¯è‡ªç”±è½¯ä»¶ï¼Œæœªç»è®¸å¯ä¸èƒ½å»æ‰CRMEBç›¸å…³ç‰ˆæƒ
// +----------------------------------------------------------------------
// | Author: CRMEB Team <admin@crmeb.com>
// +----------------------------------------------------------------------
	const app = getApp();
	let sysHeight = uni.getSystemInfoSync().statusBarHeight
	import {	toLogin } from '@/libs/login.js';
	import { mapGetters } from 'vuex';
	import { configMap } from '@/utils';
	/*
	å¼•å…¥è¯„è®ºç»„ä»¶
	*/
	import douyinScrollview from '../components/douyin-scrollview/douyin-scrollview.nvue'
	import mentioned from '../components/mentioned/mentioned.vue'
	import { videoList, myVideoList, graphicStartApi, followAuthorApi, deletePlantApi, focusArticleLst } from '@/api/community.js';
	import { HTTP_REQUEST_URL } from '@/config/app.js';
	import { getUserInfo } from '@/api/user.js';
	export default {
		computed: configMap({statusBarHeight: 0,community_reply_status:0},mapGetters(['isLogin', 'uid'])),
    data() {
			return {
				imgHost: HTTP_REQUEST_URL,
				//ä¸‹é¢æ‰“ğŸŒŸå·çš„æ˜¯å¿…é¡»è¦çš„åŸºç¡€å­—æ®µ
				//ä¸‹é¢æ‰“ğŸ’—å·çš„æ˜¯æ‹¥æœ‰æ»‘åŠ¨æ¡çš„å¿…é¡»å­—æ®µ
				dataList:[],//ç”¨äºæ•°æ®å¾ªç¯çš„åˆ—è¡¨ğŸŒŸğŸ’—
				wHeight:0,//è·å–çš„å±å¹•é«˜åº¦ğŸŒŸğŸ’—
				boxStyle:{//è§†é¢‘ï¼Œå›¾ç‰‡å°é¢æ ·å¼ğŸŒŸğŸ’—
					'height': 0,
					'width': 0,
				},
				k:0,//é»˜è®¤ä¸º0ğŸŒŸğŸ’—
				max: 2,
				playIngIds:[],//æ­£åœ¨æ’­æ”¾çš„è§†é¢‘idåˆ—é˜Ÿï¼Œåˆ—é˜Ÿç”¨äºå¤„ç†æ»‘åŠ¨è¿‡å¿«å¯¼è‡´çš„è·³é¢‘é—®é¢˜ğŸŒŸğŸ’—
				ready:false,//å¯å¿½ç•¥
				isDragging: false,//falseä»£è¡¨åœæ­¢æ»‘åŠ¨ğŸŒŸğŸ’—
				refreshing: true,//ç”¨äºä¸‹æ‹‰åˆ·æ–°ğŸŒŸğŸ’—
				windowWidth: 0,//è·å–å±å¹•å®½åº¦ğŸŒŸğŸ’—
				windowHeight: 0,
				dex: [0,0],//ç”¨äºåˆ¤æ–­æ˜¯ä¸Šæ»‘è¿˜æ˜¯ä¸‹æ»‘ï¼Œç¬¬ä¸€ä¸ªå­˜æ—§å€¼ï¼Œç¬¬äºŒä¸ªå­˜æ–°å€¼ã€ç›®å‰åœ¨1.0.7å·²ç»åºŸå¼ƒã€‘
				currents: 0,//ç”¨äºå·¦å³æ»‘åŠ¨ï¼Œ0ä»£è¡¨è§†é¢‘ç•Œé¢ï¼Œ1ä»£è¡¨å³æ»‘ç•Œé¢ğŸŒŸğŸ’—
				platform: '',//ç”¨äºè·å–æ“ä½œç³»ç»Ÿï¼šiosã€androidğŸŒŸğŸ’—
				playIng: false,//ç”¨äºè§†é¢‘åˆå§‹åŒ–æ—¶æ˜¯å¦æ’­æ”¾ï¼Œé»˜è®¤ä¸æ’­æ”¾ğŸŒŸğŸ’—
				videoTime: '',//è§†é¢‘æ€»æ—¶é•¿ï¼Œè¿™ä¸ªä¸»è¦ç”¨æ¥æˆªå–æ—¶é—´æ•°å€¼ğŸ’—
				videoTimes: '',//è§†é¢‘æ—¶é•¿ï¼Œç”¨è¿™ä¸ªæ¥è·å–æ—¶é—´å€¼ï¼Œä¾‹å¦‚ï¼š00:30è¿™ä¸ªæ—¶é—´å€¼ğŸ’—
				changeTime: '',//æ˜¾ç¤ºæ»‘åŠ¨è¿›åº¦æ¡æ—¶å˜åŒ–çš„æ—¶é—´ğŸ’—
				isShowimage: false,//æ˜¯å¦æ˜¾ç¤ºå°é¢ã€1.0.4å·²åºŸå¼ƒï¼Œä½†æ˜¯æ„æ€éœ€è¦è®°ä½ã€‘
				currenttimes: 0,//å½“å‰æ—¶é—´ğŸ’—
				isShowProgressBarTime: false,//æ˜¯å¦æ‹–åŠ¨è¿›åº¦æ¡ï¼Œå¦‚æœæ‹–åŠ¨ï¼ˆtrueï¼‰åˆ™æ˜¾ç¤ºè¿›åº¦æ¡æ—¶é—´ï¼Œå¦åˆ™ä¸æ˜¾ç¤ºï¼ˆfalseï¼‰ã€1.0.4å·²åºŸå¼ƒï¼Œä½†æ˜¯æ„æ€éœ€è¦è®°ä½ã€‘
				ProgressBarOpacity: 0.7,//è¿›åº¦æ¡ä¸æ‹–åŠ¨æ—¶çš„é»˜è®¤å€¼ï¼Œå°±æ˜¯é€æ˜çš„ğŸ’—
				dotWidth: 0,//æ’­æ”¾çš„å°åœ†ç‚¹ï¼Œé»˜è®¤æ²¡æœ‰ğŸ’—
				deleteHeight: 0,//æµ‹è¯•é«˜åº¦ğŸŒŸğŸ’—
				percent: 0,//ç™¾åˆ†å°æ•°ğŸ’—
				currentPosition: 0,//æ»‘å—å½“å‰ä½ç½®ğŸ’—//2.0å·²å¼ƒç”¨ï¼Œç°å·²ç”¨äºåç«¯å‚æ•°
				currentPositions: 0,//æ»‘å—å½“å‰ä½ç½®çš„å‰¯æœ¬ğŸ’—//2.0å·²å¼ƒç”¨ï¼Œç°å·²ç”¨äºåç«¯å‚æ•°
				newTime: 0,//è·Ÿæ‰‹æ»‘åŠ¨åçš„æœ€æ–°æ—¶é—´ğŸ’—
				timeNumber: 0,//ğŸŒŸğŸ’—
				ProgressBarBottom: 20,//è¿›åº¦æ¡ç¦»åº•éƒ¨çš„è·ç¦»ğŸ’—
				object_fit: 'contain',//è§†é¢‘æ ·å¼é»˜è®¤åŒ…å«ğŸŒŸğŸ’—
				mode: 'aspectFit',//å›¾ç‰‡å°é¢æ ·å¼ğŸŒŸğŸ’—
				timeout: "",//ğŸŒŸç”¨æ¥é˜»æ­¢ setTimeout()æ–¹æ³•
				voice: "",//ğŸŒŸç”¨æ¥é˜»æ­¢ setTimeout()æ–¹æ³•
				oldVideo: "",
				isAutoplay: false,//æ˜¯å¦å¼€å¯è‡ªåŠ¨æ’­æ”¾(é»˜è®¤ä¸å¼€å¯)
				autoplayText: "å¼€å¯è‡ªåŠ¨æ’­æ”¾",
				timers: "",
				// å¼•å…¥è¯„è®º - å‚æ•°
				heightNum: 1.8,
				// åŒå‡»ç‚¹èµå‚æ•°
				touchNum: 0,
				aixinLeft: 0,
				aixinTop: 0,
				showComment: false,
				loadVideo: true,
				loaded: false,
				Rotate: 0,
				currentNav:1,
				limit: 6,
				page: 1,
				userInfo: {uid: 0},
				moreList: [],
				authorUid: 0,
				showManage: false,
				isUser: false,
				isSatrt: 0,
				userUid: 0,
				sysHeight: sysHeight,
			}
    },
		components:{
			douyinScrollview,
			mentioned,
		},
		watch:{
			async k(new_k,old_k){//ç›‘å¬ k å€¼çš„å˜åŒ–ï¼Œå¯ä»¥æ§åˆ¶è§†é¢‘çš„æ’­æ”¾ä¸æš‚åœ
				const max = new_k+2;
				if(this.max < max){
					this.max = max;
				}
				this.dataList[old_k].playIng = false //å¦‚æœè§†é¢‘æš‚åœï¼Œå°±åŠ è½½å°é¢
				this.dataList[old_k].isplay = true
				this.dataList[old_k].state = 'pause'
				console.log('é¢„ç•™ç¬¬' + (old_k) + 'ä¸ªè§†é¢‘ï¼š' + this.dataList[old_k].community_id)
				// 2.0ç‰ˆæœ¬å·²ç»å»æ‰äº†ä¸‹é¢è¿™ä¸€å¥ï¼Œè§†é¢‘ä¸ç”¨æš‚åœï¼Œåªéœ€è¦æŠŠå£°éŸ³ç¦æ­¢å°±è¡Œ
				uni.createVideoContext(this.dataList[old_k].community_id, this).pause() //å¦‚æœè§†é¢‘æš‚åœï¼Œé‚£ä¹ˆæ—§è§†é¢‘åœæ­¢ï¼Œè¿™é‡Œçš„this.dataList[old_k].id + '' + old_kï¼Œåé¢åŠ  old_k æ˜¯ä¸ºäº†æ¯ä¸€ä¸ªè§†é¢‘çš„ id å€¼ä¸åŒï¼Œè¿™æ ·å°±å¯ä»¥å¤§ç¨‹åº¦çš„é¿å…ä¸²éŸ³é—®é¢˜
				console.log('å·²ç»æš‚åœ --> ç¬¬' + (old_k) + 'ä¸ªè§†é¢‘ï½') //æç¤º
				this.dataList[new_k].state = 'play'
				this.dataList[new_k].isplay = false
				this.dataList[new_k].playIng = true
				uni.createVideoContext(this.dataList[new_k].community_id, this).play()
			}
		},
		onShow(){
			uni.hideLoading();
			console.log('å›åˆ°å‰å°'+this.dataList.length);
			if(this.dataList.length !== 0){
				this.dataList[this.k].state = 'play';
				setTimeout(() => {
					uni.createVideoContext(this.dataList[this.k].community_id,this).play()
				}, 250)
			}
		},
		onHide(){
			this.dataList[this.k].state = 'pause';//ç•Œé¢éšè—ä¹Ÿè¦åœæ­¢æ’­æ”¾è§†é¢‘
			setTimeout(() => {
				uni.createVideoContext(this.dataList[this.k].community_id,this).pause();//æš‚åœä»¥åç»§ç»­æ’­æ”¾
			}, 250)
		},
		onLoad(options){
			this.videoID = options.id || 0;
			this.isUser = options.user==1 ? true : false;
			this.userUid = options.uid ? options.uid : 0;
			this.isSatrt = options.tab == 1 ? 1 : 0;
			if (options.pid) app.globalData.spid = options.pid;
			this.platform = uni.getSystemInfoSync().platform
			this.windowWidth = uni.getSystemInfoSync().screenWidth//è·å–å±å¹•å®½åº¦
			this.boxStyle.width = this.windowWidth + 'px'//ç»™å®½åº¦åŠ px
			this.wHeight = uni.getSystemInfoSync().screenHeight;//è·å–å±å¹•é«˜åº¦
			this.boxStyle.height = this.wHeight;//æ”¹å˜è§†é¢‘é«˜åº¦
			this.get()//è¿™ä¸€æ­¥ï¼ŒåŠ è½½è§†é¢‘æ•°æ®
			if(this.isLogin)this.getUserInfo()
		},
		onReady() {
		},
    methods: {
			goBack: function() {
				uni.navigateBack();
			},
			navTap(n){
				this.currentNav = n;
				this.dataList.forEach(item=>{
					item.state = 'pause';
				})
				this.oldVideo = "";
				this.k = 0;
				this.page = 1;
				this.loadVideo = true;
				this.dataList = [];
				n == 1 ? this.get() : this.getFocusList()
			},
			pinlunFun(e){
				this.dataList[e]['count_reply']++
			},
			// #ifdef APP-PLUS
			appShare(scene,id) {
				let that = this
				uni.showLoading({
					title: 'åŠ è½½ä¸­',
					mask: true
				});
				let uid = this.uid?this.uid:0;
				let data = this.dataList[this.k];
				let routes = getCurrentPages(); // è·å–å½“å‰æ‰“å¼€è¿‡çš„é¡µé¢è·¯ç”±æ•°ç»„
				let curRoute = routes[routes.length - 1].$page.fullPath // è·å–å½“å‰é¡µé¢è·¯ç”±ï¼Œä¹Ÿå°±æ˜¯æœ€åä¸€ä¸ªæ‰“å¼€çš„é¡µé¢è·¯ç”±
				uni.share({
					provider: "weixin",
					scene: scene,
					type: 0,
					href: `${HTTP_REQUEST_URL}/pages/short_video/nvueSwiper/index?&id=${id}`,
					title: data.title || '',
					summary: data.content || '',
					imageUrl: data.image[0] || '',
					success: function(res) {
						uni.showToast({
							title: 'åˆ†äº«æˆåŠŸ',
							icon: 'success'
						})
						uni.hideLoading();
					},
					fail: function(err) {
						uni.hideLoading();
						const failReasonMap = {
							"-8": "æœªå®‰è£…å¾®ä¿¡",
							"-7": "æœªé…ç½®åˆ†äº«å‚æ•°",
						};
						const failReason = failReasonMap[err.errCode];
						uni.showToast({
							title: 'åˆ†äº«å¤±è´¥' + (failReason ? ": " + failReason : ""),
							icon: 'none',
							duration: 2000
						})
					}
				});
			},
			// #endif
			/**
			 * è·å–ä¸ªäººç”¨æˆ·ä¿¡æ¯
			 */
			getUserInfo: function() {
				let that = this;
				getUserInfo().then(res => {
					that.userInfo = res.data;
				});
			},
			// å…³æ³¨ä½œè€…
			followAuthor: function(item) {
				if (this.isLogin === false) {
					toLogin()
				}else{
					let status = 1
					followAuthorApi(item.uid,{status:status}).then(res => {
						if (res.status === 200) {
							item.is_fans = true
						}
						uni.showToast({
							title: res.message,
							icon: 'none',
							duration: 2000
						});
					}).catch(err=>{
						return uni.showToast({
							title: err,
							icon: 'none',
							duration: 2000
						});
					});
				}
			},
			// åˆ é™¤è¯é¢˜
			deleteTopic(item){
				let that = this;
				uni.showModal({
				  content: 'ç¡®å®šè¦åˆ é™¤è¯¥è¯é¢˜ä¹ˆï¼Ÿ',
				  success: function(res) {
				    if(res.confirm) {
				      deletePlantApi(item.community_id).then(res => {
				      	uni.showToast({
				      		title: res.message,
				      		icon: 'none',
				      		duration: 2000
				      	});
								setTimeout(()=>{
									uni.redirectTo({
										url: `/pages/plantGrass/plant_user/index?id=${item.uid}`
									})
								},1000)
				      })
				    } else if(res.cancel) {
				      console.log('ç”¨æˆ·ç‚¹å‡»å–æ¶ˆ');
				    }
				  }
				});
			},
			moreTap(item){
				item.isMore = !item.isMore;
			},
			autoPlay(){
				this.isAutoplay = !this.isAutoplay;
				if(!this.isAutoplay){
					this.autoplayText = "å¼€å¯è‡ªåŠ¨æ’­æ”¾"
					uni.showToast({
						title: "å…³é—­è‡ªåŠ¨æ’­æ”¾",
						icon: 'none',
						duration: 3000
					})
				} else {
					this.autoplayText = "å…³é—­è‡ªåŠ¨æ’­æ”¾"
					uni.showToast({
						title: "å¼€å¯è‡ªåŠ¨æ’­æ”¾",
						icon: 'none',
						duration: 3000
					})
				}
			},
			getData(){
				// è¿™é‡Œå°±æ˜¯æ•°æ®åŠ è½½å®Œä»¥åå†å‘åç«¯å‘é€æ•°æ®çš„åœ°æ–¹,
				let that = this;
				if(!that.loadVideo) return
				if(that.loaded) return
				that.loadVideo = true
				that.isUser ?
					myVideoList(that.userUid,{
						page: that.page,
						limit: that.limit,
						is_star: that.isSatrt,
						community_id: that.videoID
					}).then(res=>{
						that.loadVideo = false
						that.loadend = res.data.list.length < that.limit
						that.getVideoData(res.data.list);
					}).catch(err=>{
						return uni.showToast({
							title: err,
							icon: 'none',
							duration: 2000
						});
					}) :
					videoList({
						page: that.page,
						limit: that.limit,
						id: that.videoID
					}).then(res=>{
						that.loadVideo = false
						that.loadend = res.data.list.length < that.limit
						that.getVideoData(res.data.list);
					}).catch(err=>{
						return uni.showToast({
							title: err,
							icon: 'none',
							duration: 2000
						});
					})
			},
			getFocusList(){
				let that = this;
				if(!that.loadVideo) return
				that.loadVideo = true
				focusArticleLst({
					page: that.page,
					limit: that.limit,
					}).then(res=>{
					that.loadVideo = false
					that.getVideoData(res.data.list)
				}).catch(err=>{
					return uni.showToast({
						title: err,
						icon: 'none',
						duration: 2000
					});
				})
			},
			getVideoData(list){
				console.log(list.length)
				if(list.length == 0) return
				let that = this;
				that.loadVideo = list.length == that.limit
				that.page = that.page + 1;
				var msg = list
				for (let i = 0; i < msg.length; i++) {
					msg[i]['isMore'] = false
					msg[i]['playIng'] = false
					msg[i]['state'] = false
					msg[i]['isplay'] = false
					msg[i]['loading'] = false
					msg[i]['community_id'] = msg[i]['community_id'].toString()
					that.dataList.push(msg[i])
				}
				if(that.dataList.length !== 0){
					that.dataList[that.k].state = 'play';
					setTimeout(function() {
						uni.createVideoContext(that.dataList[that.k].community_id,that).play()
					}, 10);
				}
			},
			touchstart(event){
				this.dataList[this.k].isShowimage = true //åˆšè§¦æ‘¸çš„æ—¶å€™å°±è¦æ˜¾ç¤ºé¢„è§ˆè§†é¢‘å›¾ç‰‡äº†
				this.dataList[this.k].isShowProgressBarTime = true //æ˜¾ç¤ºæ—¶é—´çº¿
				this.ProgressBarOpacity = 1 //è®©æ»‘å—æ˜¾ç¤ºèµ·æ¥æ›´æ˜æ˜¾ä¸€ç‚¹
				this.dotWidth = 10 //è®©ç‚¹æ˜¾ç¤ºèµ·æ¥æ›´æ˜æ˜¾ä¸€ç‚¹
			},
			touchend(){//å½“æ‰‹æ¾å¼€åï¼Œè·³åˆ°æœ€æ–°æ—¶é—´
				uni.createVideoContext(this.dataList[this.k].community_id,this).seek(this.newTime)
				if(this.dataList[this.k].state == 'pause'){
					this.dataList[this.k].state = 'play'
					uni.createVideoContext(this.dataList[this.k].community_id,this).play()
				}
				this.dataList[this.k].isShowProgressBarTime = false //è§¦æ‘¸ç»“æŸåï¼Œéšè—æ—¶é—´çº¿
				this.dataList[this.k].isShowimage = false //è§¦æ‘¸ç»“æŸåï¼Œéšè—æ—¶é—´é¢„è§ˆ
				this.ProgressBarOpacity = 0.5 //éšè—èµ·æ¥è¿›åº¦æ¡ï¼Œä¸é‚£ä¹ˆæ˜æ˜¾äº†
				this.dotWidth = 0 //éšè—èµ·æ¥è¿›åº¦æ¡ï¼Œä¸é‚£ä¹ˆæ˜æ˜¾äº†
			},
			touchmove(event){//å½“æ‰‹ç§»åŠ¨æ»‘å—æ—¶ï¼Œè®¡ç®—ä½ç½®ã€ç™¾åˆ†å°æ•°ã€æ–°çš„æ—¶é—´
				var msg = []
				if(this.videoTime !== ''){
					msg = this.videoTime.split(':')
				}
				var timeNumber = Number(msg[0])*60 + Number(msg[1])
				this.currentPositions = event.changedTouches[0].screenX
				this.percent = this.currentPositions / this.windowWidth
				this.newTime = this.percent*timeNumber
				this.currenttimes = parseInt(this.newTime)
				let theTime = this.newTime
				let middle = 0;// åˆ†
				if(theTime > 60) {
					middle = parseInt(theTime/60);
					theTime = parseInt(theTime%60);
				}
				this.changeTime = `${Math.round(middle)>9?Math.round(middle):'0'+Math.round(middle)}:${Math.round(theTime)>9?Math.round(theTime):'0'+Math.round(theTime)}`
			},
			timeupdate(event,index){//è®¡ç®—æ»‘å—å½“å‰ä½ç½®ï¼Œè®¡ç®—å½“å‰ç™¾åˆ†å°æ•°
				if(index == this.k){
					var currenttime = event.detail.currentTime
					this.timeNumber = Math.round(event.detail.duration)
					this.getTime()
					this.percent = currenttime/this.timeNumber
					this.currentPosition = this.windowWidth*this.percent
					let theTime = currenttime
					let middle = 0;// åˆ†
					if(theTime > 60) {
						middle = parseInt(theTime/60);
						theTime = parseInt(theTime%60);
					}
					this.changeTime = `${Math.round(middle)>9?Math.round(middle):'0'+Math.round(middle)}:${Math.round(theTime)>9?Math.round(theTime):'0'+Math.round(theTime)}`
					//è‡ªåŠ¨åˆ‡æ¢è§†é¢‘
					if(this.isAutoplay){//true,ä»£è¡¨è‡ªåŠ¨æ’­æ”¾
						if(Math.round(currenttime) == this.timeNumber - 1){
							const dom = uni.requireNativePlugin('dom')
							let doms = 'item'+(this.k+1)
							setTimeout(()=>{
								let el = this.$refs[doms][0]
								dom.scrollToElement(el,{
									offset: 0,
									animated: true
								})
							},500)
						}
					}
				}
			},
			getTime(){//å¾—åˆ°æ—¶é—´å‡½æ•°
				this.videoTime = this.formatSeconds(this.timeNumber);
				var msg = []
				if(this.videoTime !== ''){
					msg = this.videoTime.split(':')
				}
				this.videoTimes = `${msg[0]>9?msg[0]:'0'+msg[0]}:${msg[1]>9?msg[1]:'0'+msg[1]}`;
			},
			formatSeconds(value) {//è·å–æ—¶é—´å‡½æ•°
				let theTime = parseInt(value);// ç§’
				let middle= 0;// åˆ†
				if(theTime > 60) {
					middle= parseInt(theTime/60);
					theTime = parseInt(theTime%60);
				}
				return `${middle>9?middle:middle}:${theTime>9?theTime:theTime}`;
			},
			moreVideo(index){

			},
			toVideo(index){

			},
			scrolls (event) {
				this.showManage = false;
				this.isDragging = event.isDragging;
				if (!event.isDragging) {//isDraggingï¼šåˆ¤æ–­ç”¨æˆ·æ˜¯ä¸æ˜¯åœ¨æ»‘åŠ¨ï¼Œæ»‘åŠ¨ï¼štrueï¼Œåœæ­¢æ»‘åŠ¨ï¼šfalseã€‚æˆ‘ä»¬è¦ç”¨æˆ·åœæ­¢æ»‘åŠ¨æ—¶æ‰ç»™ k èµ‹å€¼ï¼Œè¿™æ ·å°±å¯ä»¥é¿å…å¾ˆå¤šéº»çƒ¦
					var i = Math.round(Math.abs(event.contentOffset.y) / (this.wHeight - this.deleteHeight + 1))//å…ˆç”¨ç»å¯¹å€¼å–å‡ºæ»‘åŠ¨çš„è·ç¦»ï¼Œç„¶åé™¤ä»¥å±å¹•é«˜åº¦ï¼Œå–ä¸€ä¸ªæ•´ï¼Œå°±çŸ¥é“ä½ ç°åœ¨æ»‘åŠ¨åˆ°å“ªä¸€ä¸ªè§†é¢‘äº†
					if(i !== this.k){//è¿™é‡ŒåŠ åˆ¤æ–­æ˜¯å› ä¸ºè¿™ä¸ªæ–¹æ³•ä¼šæ‰§è¡Œå¾ˆå¤šæ¬¡ï¼Œä¼šé€ æˆé‡å¤è¯·æ±‚ï¼Œæ‰€ä»¥è¿™é‡Œå†™ä¸€ä¸ªé™åˆ¶
						if(uni.getSystemInfoSync().platform == 'ios'){
							this.k = i//åˆ¤æ–­äº†ç”¨æˆ·æ²¡æœ‰æ»‘åŠ¨ï¼Œç¡®è®¤äº†ç”¨æˆ·çš„ç¡®æ˜¯åœ¨çœ‹è¿™ä¸ªè§†é¢‘ï¼Œç„¶åå°±èµ‹å€¼å•¦
							this.dataList[this.k].state = 'play'
							console.log('æ­£åœ¨æ’­æ”¾ --> ç¬¬' + (this.k + 1) + 'ä¸ªè§†é¢‘ï½')
						} else {
							clearTimeout(this.timers);
							this.timers = setTimeout(()=>{
								this.k = i//åˆ¤æ–­äº†ç”¨æˆ·æ²¡æœ‰æ»‘åŠ¨ï¼Œç¡®è®¤äº†ç”¨æˆ·çš„ç¡®æ˜¯åœ¨çœ‹è¿™ä¸ªè§†é¢‘ï¼Œç„¶åå°±èµ‹å€¼å•¦
								this.dataList[this.k].state = 'play'
								console.log('æ­£åœ¨æ’­æ”¾ --> ç¬¬' + (this.k + 1) + 'ä¸ªè§†é¢‘ï½')
							},80)
						}
					}
				}
			},
			get(){
				if(!this.loadVideo) return
				if(this.loaded) return
				this.loadVideo = true
				// è¿™ä¸ªæ–¹æ³•ä¸»è¦å°±æ˜¯ç”¨æ¥ç¬¬ä¸€æ¬¡è¿›å…¥è§†é¢‘æ’­æ”¾æ—¶ç”¨æ¥å¤„ç†çš„
				this.isUser ?
				myVideoList(this.userUid,{
						page: this.page,
						limit: this.limit,
						is_star: this.isSatrt,
						community_id: this.videoID
					}).then(async (res)=>{
						this.loadVideo = false
						this.loadend = res.data.list.length < this.limit
						this.page = this.page + 1;
						var msg = res.data.list;
						for (let i = 0; i < msg.length; i++) {
							msg[i]['isMore'] = false
							msg[i]['playIng'] = false
							msg[i]['state'] = false
							msg[i]['isplay'] = false
							msg[i]['loading'] = false
							msg[i]['community_id'] = msg[i]['community_id'].toString()
						}
						this.dataList = msg;
						if(this.dataList.length !== 0){
							this.dataList[this.k].state = 'play';
							uni.createVideoContext(this.dataList[this.k].community_id,this).play()
						}
				}).catch(err=>{
					return uni.showToast({
							title: err,
							icon: 'none',
							duration: 2000
						});
				}) :
				videoList({
					page: this.page,
					limit: this.limit,
					id: this.videoID
				}).then(async (res)=>{
					console.log(res.data.list.length)
					this.loadend = res.data.list.length < this.limit
					this.page = this.page + 1;
					var msg = res.data.list;
					for (let i = 0; i < msg.length; i++) {
						msg[i]['isMore'] = false
						msg[i]['playIng'] = false
						msg[i]['state'] = false
						msg[i]['isplay'] = false
						msg[i]['community_id'] = msg[i]['community_id'].toString()
					}
					this.dataList = msg;
				}).catch(err=>{
					return uni.showToast({
						title: err,
						icon: 'none',
						duration: 2000
					});
				})
			},
			onpullingdown(){
				this.refreshing = true
			},
			onrefresh(){
				setTimeout(()=>{
					this.refreshing = false
				},1000)
			},
			//ç‚¹å‡»æ’­æ”¾&&æš‚åœ
			tapVideoHover(state,event){
				this.dataList[this.k].isShowimage = false
				this.dataList[this.k].isShowProgressBarTime = false
				this.ProgressBarOpacity = 0.5
				this.dotWidth = 0
				this.touchNum++;
				setTimeout(()=>{
					if(this.touchNum == 1){
						if(state=='play'||state=='continue'){
							this.dataList[this.k].state = 'pause';
						}else{
							this.dataList[this.k].state = 'continue';
						}
						if(this.dataList[this.k].state == 'continue'){
							uni.createVideoContext(this.dataList[this.k].community_id,this).play();//æš‚åœä»¥åç»§ç»­æ’­æ”¾
						}
						if(this.dataList[this.k].state == 'pause'){
							uni.createVideoContext(this.dataList[this.k].community_id,this).pause();//æš‚åœä»¥åç»§ç»­æ’­æ”¾
						}
					}
					this.touchNum = 0;
				},200)
			},
			toComment(item,index){
				// æ³¨æ„ç‚¹å‡»è¯„è®ºä¹‹åä¼šæ‰§è¡Œè¿™é‡Œ
				/*
				ï¼ˆ1ï¼‰å…ˆåŠ è½½ç¼“å†²
				ï¼ˆ2ï¼‰è·å–å½“å‰è§†é¢‘ ID ä¿¡æ¯
				ï¼ˆ3ï¼‰ğŸŒŸğŸŒŸğŸŒŸğŸŒŸé‡è¦ğŸŒŸğŸŒŸğŸŒŸğŸŒŸ
					- ä¸€å®šè¦è®°å¾—çœ‹ index.vue é‡Œé¢
					 uni.setStorageSync("user",this.peopleList[i]);
					 è¿™ä¸ªä¸œè¥¿ï¼Œç”¨äºå­˜å‚¨å½“å‰ç”¨æˆ·ä¿¡æ¯ã€‚åœ¨ æ’ä»¶é‡Œé¢ä¼šä½¿ç”¨åˆ°è¿™ä¸ªä¸œè¥¿ï¼Œ
					 è®°å¾—å†™ä¸€ä¸‹ã€‚

				ï¼ˆ4ï¼‰æ‰“å¼€è¯„è®º
				*/
			 uni.setStorageSync("videoList",item);
			 uni.setStorageSync("videoIndex",index);
				this.$refs.pinglun.open('bottom')
			},
			cLike(item){
				if (this.isLogin === false) {
					toLogin()
				}else{
					let status = item.relevance_id ? 0 : 1
					graphicStartApi(item.community_id,{status: status}).then(res=>{
						if(item.relevance_id){
							item.count_start--;
							item.count_start = item.count_start == 0 ? 0 : item.count_start
							item.relevance_id = false
						}else{
							item.count_start++;
							item.relevance_id = true
						}
					}).catch(err=>{
						return uni.showToast({
							title: err,
							icon: 'none',
							duration: 2000
						});
					})
				}
			},
			moveHandle(){},
			closeScrollview(){
				// ç‚¹å‡»è¯„è®ºé‡Œé¢çš„å‰å‰ï¼Œå°±ä¼šå…³é—­è¯„è®º
				this.$refs.pinglun.close();
			},
			/*æŸ¥çœ‹æåˆ°çš„å®è´*/
			openMore(item){
				this.$refs.pinglunMentioned.open('bottom');
				this.moreList = item.relevance;
				this.authorUid = item.uid
			},
			closePopup(){
				this.$refs.pinglunMentioned.close();
			},
			goDetail(item){
				if (item.product_type === 1) {
					uni.navigateTo({
						url: `/pages/activity/goods_seckill_details/index?id=${item.product_id}&time=${item.stop_time}&spid=${this.uid}`
					})
				} else if (item.product_type === 2) {
					uni.navigateTo({
						url: `/pages/activity/presell_details/index?id=${item.activity_id}&spid=${this.uid}`
					})
				} else if (item.product_type === 0) {
					uni.navigateTo({
						url: `/pages/goods_details/index?id=${item.product_id}&spid=${this.uid}`
					})
				}else if (item.product_type === 4) {
					uni.navigateTo({
						url: `/pages/activity/combination_details/index?id=${item.activity_id}&spid=${this.uid}`
					})
				}else if (item.product_type === 40) {
					uni.navigateTo({
						url: `/pages/activity/combination_status/index?id=${item.activity_id}&spid=${this.uid}`
					})
				}
			}
    },
		// onReachBottom() {
		// 	uni.$emit('onReachBottom');
		// },
  }
</script>
<style lang="scss" scoped>
	.noVideo{
		position: fixed;
		top: 400rpx;
		z-index: 9;
		width:750rpx;
		flex-direction: row;
		justify-content: center;
		.pictrue{
			width: 414rpx;
			height: 256rpx;
		}
		.tips{
			text-align: center;
			margin-top: 14rpx;
			font-size: 26rpx;
			color: #999;
		}
	}
	.fixed-head{
		flex-direction: row;
		justify-content: center;
		align-items: center;
		position: fixed;
		left: 0;
		top: 70rpx;
		height: 86rpx;
		.icon-ic_leftarrow {
			margin-left: 10px;
			width: 13px;
			height: 14px;
			color: #ffffff;
		}
	}
	.header{
		position: fixed;
		z-index: 9;
		width: 750rpx;
		height: 86rpx;
		flex-direction: row;
		justify-content: center;
		align-items: center;
		top: 70rpx;
		.items{
			margin: 0 30rpx;
			.tName{
				color: #ffffff;
				font-size: 32rpx;
				&.on{
					font-size: 38rpx;
				}
			}
		}
	}
	.container {background: #000000;}
  .item {
		position: relative;
	}
	.videoHover{
		position: absolute;
		top: 0;
		left: 0;
		flex: 1;
		background-color: rgba(0,0,0,0.1);
		justify-content: center;
		align-items: center;
	}
	.playState{
		width:  160rpx;
		height: 160rpx;
		opacity: 0.2;
	}
	.video-status{
		width: 690rpx;
		position: absolute;
		left: 30rpx;
		background: rgba(0,0,0,.5);
		border-radius: 16rpx;
		top: 150rpx;
		padding: 30rpx;
		.status-title{
			flex-direction: row;
			align-items: center;
			.title{
				margin-left: 20rpx;
				color: #ffffff;
				font-size: 28rpx;
			}
		}
		.refusal{
			color: #ffffff;
			font-size: 22rpx;
			margin: 15rpx 0 0 48rpx;
		}
		.image{
			width: 28rpx;
			height: 28rpx;
		}
	}
	.userInfo{
		position: absolute;
		bottom: 30px;
		right: 10px;
		display: flex;
		align-items: center;
		flex-direction: column;
		.pictrue{
			flex-direction: column;
			justify-content: center;
			align-items: center;
			position: relative;
			// margin-bottom: 18rpx;
			.guanzhu{
				width: 42rpx;
				height: 42rpx;
				display: flex;
				align-items: center;
				justify-content: center;
				color: #fff;
				background: #E93323;
				border-radius: 100%;
				position: relative;
				top: -20rpx;
				left: 3rpx;
				.iconfont{
					font-size: 30rpx;
					color: #fff;
				}
			}
			.yiguanzhu{
				width: 42rpx;
				height: 42rpx;
			}
		}
	}
	.video-my{
		position: relative;
		align-items: center;
		justify-content: center;
		flex-direction: row;

	}
	.video-dian{
		position: relative;
		width: 33px;
		height: 33px;
		align-items: center;
		justify-content: center;
		flex-direction: row;
		left: 3px;
		.dian{
			width: 7px;
			height: 7px;
			background-color: #fff;
			border-radius: 100%;
			margin-right: 3px;
			&:last-child{
				margin-right: 0;
			}
		}
	}
	.manage{
		width: 115px;
		background: #ffffff;
		box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
		padding: 0 8px;
		position: absolute;
		bottom: 10px;
		right: 60px;
		border-radius: 8px;
		.manage-gou{
			display: flex;
			width: 13px;
			height: 13px;
			background: #ffffff;
			transform: rotate(140deg);
			position: absolute;
			top: 30px;
			right: -6px;
			box-shadow: -1px -1px 1px rgba(0, 0, 0, 0.05);
		}
		.items{
			border-bottom: 1px solid #EEEEEE;
			padding: 10px 0;
			display: flex;
			align-items: center;
			flex-direction: row;
			.text{
				color: #282828;
				font-size: 13px;
			}
			&:last-child{
				border-bottom-color: transparent;
			}
			.image{
				width: 32rpx;
				height: 32rpx;
				margin: 0 16rpx 0;
			}
		}
	}
	.userAvatar{
		border-radius: 500%;
		border-style: solid;
		border-width: 2px;
		border-color: #ffffff;
		width : 80rpx;
		height: 80rpx;
	}
	.info-text{
		display: flex;
		margin-top: 10rpx;
		color: #ffffff;
		font-size: 22rpx;
		text-align: center;
		&.likeNumActive{
			color: #E93323;
		}
	}

	.likeIco,.shareIco,.commentIco{
		width : 60rpx;
		height: 60rpx;
		margin-top: 15px;
	}
	.likeNum,.commentNum,.shareTex{
		color: #ffffff;
		font-size: 30rpx;
		text-align: center;
		margin: 5px;
	}
	.mention{
		width: 46px;
		height: 46px;
		position: relative;
		.image{
			width: 30px;
			height: 30px;
			position: absolute;
			right: 8px;
		}
		.count{
			padding: 2px 6px;
			background: #fff;
			border-radius: 100%;
			display: flex;
			align-items: center;
			justify-content: center;
			color: #E93323;
			position: absolute;
			right: 6px;
			top: 0;
			font-size: 10px;
		}
	}
	.content{
	  width: 325px;
	  position: absolute;
	  bottom: 15px;
	  /* justify-content: center; */
	  padding: 15rpx;
	  flex-direction: column;
	  justify-content: flex-start;
	  color: #ffffff;
		.cart{
			height: 48rpx;
			flex-direction:row;
			.cartName{
				font-size: 24rpx;
				color: #fff;
			}
		}
		.product{
			flex-direction: row;
			margin-top: 27rpx;
			.scroll-view{
				flex-direction: row;
			}
			.product-item{
				width: 444rpx;
				height: 136rpx;
				background: rgba(0,0,0,.55);
				border-radius: 12rpx;
				padding: 16rpx 15rpx;
				margin-right: 30rpx;
			}
			.swiper{
				width: 500rpx!important;
				height: 136rpx!important;
				.swiper-count{
					width: 444rpx!important;
					height: 136rpx!important;
					background: rgba(0,0,0,.55);
					border-radius: 12rpx;
					padding: 16rpx 15rpx;
				}
				.swiper-item{
					flex-direction: row;
				}
			}
			.item-count{
				flex-direction: row;
				justify-content: space-between;
				.picture{
					width: 104rpx;
					height: 104rpx;
					border-radius: 10rpx;
					.image{
						width: 104rpx;
						height: 104rpx;
						border-radius: 10rpx;
					}
				}
				.product-text{
					width: 286rpx;
					justify-content: space-between;
					.name{
						font-size: 24rpx;
						width: 286rpx;
						color: #fff;
					}
					.product-price{
						display: flex;
						flex-direction: row;
						justify-content: space-between;
						align-items: center;
						.price{
							display: flex;
							flex-direction: row;
							.sm,.money{
								color: #ffffff;
								font-size: 24rpx;
							}
						}
						.buy-btn{
							padding: 6rpx 20rpx;
							display: flex;
							align-items: center;
							justify-content: center;
							color: #fff;
							border-radius: 26rpx;
							background: #E93323;
							font-size: 20rpx;
						}
					}
				}
			}
		}
	}
	.product_cate{
		margin: 20rpx 0;
		flex-direction: row;
		.pro-view{
			flex-direction: row;
			align-items: center;
			border-radius: 30rpx;
			padding: 0 25rpx;
			line-height: 40rpx;
			border-radius: 29rpx;
			border: 1rpx solid #ffffff;
			.text{
				color: #ffffff;
				font-size: 24rpx;
			}
			.icon{
				font-size: 26rpx;
				font-weight: bold;
				margin-right: 8rpx;
				color: #ffffff;
			}
		}
	}
	.timeCon{
		flex-direction:row;
		align-items: center;
		.userName {
		  font-size: 30rpx;
		  color: #ffffff;
		}
	}
	.words {
	  margin-top: 20rpx;
		.close{
			display: flex;
			flex-direction: row;
			align-items: center;
			justify-content: flex-end;
			margin-right: 20rpx;
			.imgClose{
				width: 18rpx;
				height: 10rpx;
				margin-left: 10rpx;
			}
		}
		.wordsCon{
			position: relative;
			.more{
				position: absolute;
				bottom: 0;
				right: 40rpx;
				font-size: 26rpx;
				color: #ffffff;
				font-weight: bold;
			}
			.img{
				width: 18rpx;
				height: 10rpx;
				margin-left: 4rpx;
				position: absolute;
				bottom: 7rpx;
				right: 20rpx;
			}
		}
		.info{
			color: #fff;
			font-size: 28rpx;
		}
		.more{
			font-size: 26rpx;
			color: #ffffff;
			font-weight: bold;
		}
	}
	.root{
		background-color: #000000;
	}
</style>
