<template>
	<view class="shortVideo" @click="showManage = false">
		<!--
		æ³¨æ„ï¼šè¿™æ˜¯ H5ã€å¾®ä¿¡å°ç¨‹åºç•Œé¢ï¼Œè¯·å‹¿å’Œ new_index.nvueã€index.nvue æ··ç”¨

		1. new_index.nvueã€index.nvueè¿™ä¸¤ä¸ªæ˜¯Appé¡µé¢

		2. å¦å¤–ï¼šdata.js æ˜¯ä¸Šä¸€ç‰ˆæœ¬ç•™ä¸‹çš„å‡æ•°æ®ï¼Œè¿™ä¸€ç‰ˆæ”¹æˆäº† URL è¯·æ±‚äº†ï¼ˆå¦‚ä¸éœ€è¦å¯ä»¥åˆ é™¤ï¼Œä¹Ÿå¯ä½œä¸ºåç«¯è¯·æ±‚å‚è€ƒï¼‰

		3. è¯·å„ä½å¤§ç¥å¤šå¤šç•™æ‰‹ï¼Œæˆ‘å·²ç»æŠŠè¯·æ±‚å†…å­˜å¼€åˆ°æœ€å¤§äº†

		4. è§†é¢‘ id åˆ‡è®°æ˜¯å­—ç¬¦ä¸²ç±»å‹
		 -->
		<!-- å¤´éƒ¨å¯¼èˆª -->
		<view v-if="!isUser" class="header" :style="{ top: mTop }">
			<view class="tool-bar">
				<view class="iconfont icon-ic_leftarrow" @tap="goBack"></view>
			</view>
			<view class="items" @click.stop="navTap(2)">
				<text class="tName" :class="currentNav == 2 ? 'on' : ''">å…³æ³¨</text>
			</view>
			<view class="items" @click.stop="navTap(1)">
				<text class="tName" :class="currentNav == 1 ? 'on' : ''">æ¨è</text>
			</view>
		</view>
		<swiper
			:style="'width: ' + windowWidth + 'px; height: ' + windowHeight + 'px;'"
			:vertical="true"
			:circular="false"
			:autoplay="false"
			:duration="300"
			@animationfinish="animationfinish"
			@change="change"
			:current="k"
			:indicator-dots="false"
		>
			<swiper-item v-for="(list, index) in dataList" :key="index">
				<view v-if="max > index">
					<view>
						<!--
						1.v-ifï¼šç”¨äºæ§åˆ¶è§†é¢‘åœ¨èŠ‚ç‚¹çš„æ¸²æŸ“æ•°
						2.mutedçš„é»˜è®¤å€¼æ˜¯ falseï¼Œä»£è¡¨é»˜è®¤æ˜¯ç¦éŸ³è§†é¢‘çš„
						3.http-cacheé»˜è®¤å¼€å¯è§†é¢‘ç¼“å­˜
						4.posterï¼ˆå°é¢ï¼ˆæ–¹æ¡ˆä¸€ï¼‰ï¼‰ï¼šè¿™é‡Œçš„å°é¢é»˜è®¤å¤„ç†å­˜å‚¨åœ¨é˜¿é‡Œäº‘çš„è§†é¢‘
						5.show-loadingï¼šè¿™é‡Œé»˜è®¤å»æ‰æ’­æ”¾è½¬åœˆçš„æ ‡å¿—
						v-if="Math.abs(k-index)<=1"
						 -->
						<video
							:id="list.community_id + '' + index"
							:loop="true"
							:muted="isMuted"
							:autoplay="index === k"
							:controls="false"
							:http-cache="true"
							:custom-cache="false"
							:page-gesture="false"
							:show-fullscreen-btn="false"
							:show-loading="false"
							:show-center-play-btn="false"
							:enable-progress-gesture="false"
							:src="list.video_link"
							@ended="ended"
							@play="play(index)"
							@click="tapVideoHover(list.state, $event)"
							@waiting="waiting(index)"
							@progress="onprogress($event)"
							@timeupdate="ontimeupdate(index, $event)"
							:style="'width: ' + windowWidth + 'px; height: ' + windowHeight + 'px;z-index: -1;'"
						></video>
					</view>
					<!-- æ’­æ”¾çŠ¶æ€ï¼špause çš„æ—¶å€™å°±ä¼šæš‚åœ -->
					<view class="videoHover" @click="tapVideoHover(list.state, $event)" :style="'width: ' + windowWidth + 'px; height: ' + windowHeight + 'px;'">
						<image v-if="list.state == 'pause'" class="playState" :src="`${imgHost}/static/images/play.png`"></image>
					</view>
					<view class="videoHover" v-if="list.loading" :style="'width: ' + windowWidth + 'px; height: ' + windowHeight + 'px;'">
						<image class="playState" :src="`${imgHost}/static/images/play.png`"></image>
					</view>
					<!--å®¡æ ¸çŠ¶æ€-->
					<view v-if="list.status == -1 || list.status == 0 || list.status == -2" class="video-status">
						<view v-if="list.status == -1 || list.status == -2" class="status-title">
							<image class="image" :src="`${imgHost}/static/images/video-failed.png`"></image>
							<text class="title">{{ list.status == -1 ? 'å®¡æ ¸æœªé€šè¿‡' : 'å·²ä¸‹æ¶' }}ï¼Œå†…å®¹ä»…è‡ªå·±å¯è§</text>
						</view>
						<view v-else class="status-title">
							<image class="image" :src="`${imgHost}/static/images/video-review.png`"></image>
							<text class="title">æ­£åœ¨å®¡æ ¸ï¼Œå†…å®¹ä»…è‡ªå·±å¯è§</text>
						</view>
						<view class="status_info">
							<text class="refusal">{{ list.status == -1 || list.status == -2 ? list.refusal : 'å‘å¸ƒçš„å†…å®¹å®¡æ ¸é€šè¿‡åï¼Œå°†åœ¨é¦–é¡µå±•ç¤ºï¼' }}</text>
						</view>
					</view>
					<view>
						<!-- æœ€åº•ä¸‹çš„æ–‡å­—éƒ¨åˆ† -->
						<view class="content">
							<view class="cart">
								<text class="cartName">@{{ list.author && list.author.nickname }}</text>
							</view>
							<view class="words" :style="'width: ' + (windowWidth - 120) + 'px;'">
								<view v-if="list.isMore || list.content.length <= 15">
									<text class="info">{{ list.content }}</text>
									<view class="close">
										<text v-if="list.isMore" class="more" @click="moreTap(list)">æ”¶èµ·</text>
									</view>
								</view>
								<view class="wordsCon" v-else>
									<text class="info">{{ list.content.slice(0, 15) }}...</text>
									<text class="more" @click.stop="moreTap(list)">å±•å¼€</text>
								</view>
							</view>
							<view v-if="list.relevance.length == 1 && k === index" class="product">
								<scroll-view scroll-x="true" style="white-space: nowrap; display: flex" scroll-with-animation show-scrollbar="true">
									<view class="product-item" v-for="(goods, idx) in list.relevance" :key="idx" v-if="goods.spu">
										<view v-if="goods.spu" class="item-count acea-row" @click="goDetail(goods.spu)">
											<view class="picture">
												<image :src="goods.spu.image"></image>
											</view>
											<view class="product-text">
												<view class="name line1">{{ goods.spu.store_name }}</view>
												<view class="product-price">
													<view class="price">
														Â¥
														<text>{{ goods.spu.price }}</text>
													</view>
													<view class="buy-btn">è´­ä¹°</view>
												</view>
											</view>
										</view>
									</view>
								</scroll-view>
							</view>
							<view v-else-if="list.relevance.length > 1 && k === index" class="product">
								<swiper :autoplay="false" :circular="circular" :interval="interval" :duration="duration" :loop="true" next-margin="20rpx">
									<block v-for="(goods, idx) in list.relevance" :key="idx" v-if="goods.spu">
										<swiper-item class="swiper-item">
											<view class="swiper-count">
												<view v-if="goods.spu" class="item-count acea-row" @click="goDetail(goods.spu)">
													<view class="picture">
														<image :src="goods.spu.image"></image>
													</view>
													<view class="product-text">
														<view class="name line1">{{ goods.spu.store_name }}</view>
														<view class="product-price">
															<view class="price">
																<priceFormat :price="goods.spu.price" weight intSize="32" floatSize="22" labelSize="22"></priceFormat>
															</view>
															<view class="buy-btn">è´­ä¹°</view>
														</view>
													</view>
												</view>
											</view>
										</swiper-item>
									</block>
								</swiper>
							</view>
							<navigator v-if="list.topic" hover-class="none" class="product_cate" :url="'/pages/plantGrass/plant_search_list/index?id=' + list.topic.topic_id">
								<view>
									<text class="icon">#</text>
									<text class="text">{{ list.topic.topic_name }}</text>
								</view>
							</navigator>
						</view>
						<view class="userInfo">
							<!-- 1.å¤´åƒ -->
							<navigator v-if="list.author && userInfo.uid != list.author.uid" hover-class="none" :url="'/pages/plantGrass/plant_user/index?id=' + list.uid" class="pictrue">
								<image class="userAvatar" :src="(list.author && list.author.avatar) || '/static/images/f.png'" mode="aspectFill"></image>
								<view v-if="!list.is_fans || !userInfo.uid" class="guanzhu" @click.stop="followAuthor(list)"><text class="iconfont icon-ic_increase"></text></view>
								<view v-else class="yiguanzhu"><text class="iconfont"></text></view>
							</navigator>
							<!-- 2.ç‚¹èµ -->
							<view @click="cLike(list)" style="margin-top: 5px" :class="{ likeNumActive: list.relevance_id }">
								<text class="iconfont icon-ic_love_2" :class="{ likeNumActive: list.relevance_id }"></text>
								<text class="info-text">{{ list.count_start > 0 ? list.count_start : 'ç‚¹èµ' }}</text>
							</view>
							<!-- 3.è¯„è®º -->
							<view v-if="community_reply_status == 1 && list.status == 1" class="comment" @click="toComment(list, index)" style="margin-top: 18px">
								<text class="iconfont icon-icon_comment"></text>
								<text class="info-text">{{ list.count_reply > 0 ? list.count_reply : 'è¯„è®º' }}</text>
							</view>
							<!-- 4.åˆ†äº« -->
							<view v-if="list.status == 1" @click="listenerActionSheet" style="margin-top: 17px">
								<text class="iconfont icon-icon_transmit"></text>
								<text class="info-text">åˆ†äº«</text>
							</view>
							<!-- 5.è‡ªå·±çš„è§†é¢‘ -->
							<view v-if="list.author && userInfo.uid == list.author.uid && isUser" style="margin-top: 17px">
								<view class="video-my">
									<view class="video-dian" @click.stop="showManage = !showManage">
										<text class="dian"></text>
										<text class="dian"></text>
										<text class="dian"></text>
									</view>
									<view class="manage" v-show="showManage">
										<navigator hover-class="none" :url="'/pages/plantGrass/plant_release/index?id=' + list.community_id + '&type=2'" class="items">
											<image class="image" :src="`${imgHost}/static/images/video-edit.png`"></image>
											<text>ç¼–è¾‘</text>
										</navigator>
										<view class="items" @click.stop="deleteTopic(list)">
											<image class="image" :src="`${imgHost}/static/images/video-delete.png`"></image>
											<text>åˆ é™¤</text>
										</view>
									</view>
								</view>
							</view>
							<!-- æåˆ°çš„å•†å“ -->
							<view v-if="list.relevance.length > 0 && k === index" @click="openMore(list)" class="mention" style="opacity: 0.9; margin-top: 18px">
								<image :src="`${imgHost}/static/images/collection.png`"></image>
								<text class="count">{{ list.relevance.length }}</text>
							</view>
							<view class="mute-btn-box" @click="handleMuteBtnClick" :class="{ 'hide': !isMuted }">
								<view class="mute-btn" :class="{ animation: index === 0 }">
									<image src="@/static/images/mute.png" class="mute-icon" />
									<text class="mute-text">å–æ¶ˆé™éŸ³</text>
								</view>
							</view>
						</view>
					</view>
				</view>
			</swiper-item>
		</swiper>
		<view class="noVideo acea-row row-center-wrapper" v-if="!dataList.length && !loadVideo">
			<view>
				<image :src="imgHost + '/static/images/noSearch.png'" class="pictrue"></image>
				<text class="tips">æš‚æ— çŸ­è§†é¢‘å†…å®¹å“¦~</text>
			</view>
		</view>
		<comment ref="comments" :bottom="0" :isShow="showComment" :userInfo="userInfo" @successFul="pinlunFun" @close="closeScrollview"></comment>
		<!-- ä»–æåˆ°çš„å®è´å¼¹çª— -->
		<mentioned ref="mentioned" @close="closePopup" :list="moreList" :uid="authorUid"></mentioned>
		<image v-if="H5ShareBox" class="shareImg" :src="imgHost + '/static/images/share-info.png'" @click="H5ShareBox = false"></image>
		<!-- åˆ†äº«æŒ‰é’® -->
		<view class="generate-posters acea-row row-middle" :class="posters ? 'on' : ''">
			<!-- #ifndef MP -->
			<button class="item" :class="weixinStatus ? 'item3' : ''" hover-class="none" v-if="weixinStatus === true" @click="H5ShareBox = true">
				<view class="iconfont icon-ic_wechat"></view>
				<view class="">å‘é€ç»™æœ‹å‹</view>
			</button>
			<!-- #endif -->
			<!-- #ifdef MP -->
			<button class="item" :class="weixinStatus ? 'item3' : ''" open-type="share" hover-class="none" @click="goFriend">
				<view class="iconfont icon-ic_wechat"></view>
				<view class="">å‘é€ç»™æœ‹å‹</view>
			</button>
			<!-- #endif -->
			<button class="item" :class="weixinStatus ? 'item3' : ''" hover-class="none" @click="goPoster">
				<view class="iconfont icon-a-ic_picture1"></view>
				<view class="">ç”Ÿæˆæµ·æŠ¥</view>
			</button>
		</view>
		<view class="mask" v-if="posters" @click="listenerActionClose"></view>
		<!-- æµ·æŠ¥å±•ç¤º -->
		<view class="mask" v-if="posterImageStatus"></view>
		<view class="poster-pop" v-if="posterImageStatus">
			<image src="/static/images/poster-close.png" class="close" @click="posterImageClose"></image>
			<image :src="posterImage" class="image"></image>
			<!-- #ifndef H5 -->
			<view class="keep" @click="savePosterPath">ä¿å­˜åˆ°ç›¸å†Œ</view>
			<!-- #endif -->
		</view>
		<canvas class="canvas" canvas-id="myCanvas" v-if="canvasStatus"></canvas>
	</view>
</template>

<script>
// +----------------------------------------------------------------------
// | CRMEB [ CRMEBèµ‹èƒ½å¼€å‘è€…ï¼ŒåŠ©åŠ›ä¼ä¸šå‘å±• ]
// +----------------------------------------------------------------------
// | Copyright (c) 2016-2026 https://www.crmeb.com All rights reserved.
// +----------------------------------------------------------------------
// | Licensed CRMEBå¹¶ä¸æ˜¯è‡ªç”±è½¯ä»¶ï¼Œæœªç»è®¸å¯ä¸èƒ½å»æ‰CRMEBç›¸å…³ç‰ˆæƒ
// +----------------------------------------------------------------------
// | Author: CRMEB Team <admin@crmeb.com>
// +----------------------------------------------------------------------
const app = getApp();
let sysHeight = uni.getSystemInfoSync().statusBarHeight + 'px';
import { toLogin } from '@/libs/login.js';
import { mapGetters } from 'vuex';
import { configMap } from '@/utils';
import comment from '../components/comment.vue';
import mentioned from '@/components/mentioned.vue';
import { HTTP_REQUEST_URL } from '@/config/app';
import { videoList, myVideoList, graphicStartApi, followAuthorApi, getVideoCode, deletePlantApi, focusArticleLst } from '@/api/community.js';
import { getUserInfo, imgToBase } from '@/api/user.js';
import ClipboardJS from '@/plugin/clipboard/clipboard.js';
export default {
	components: {
		comment,
		mentioned
	},
	computed: configMap({ community_reply_status: 0 }, mapGetters(['isLogin', 'uid'])),
	data() {
		return {
			isMuted: this.getMuteDefaultVal(),
			sysHeight: sysHeight,
			//#ifdef MP
			mTop: uni.getSystemInfoSync().statusBarHeight + 'px',
			//#endif
			//#ifndef MP
			mTop: 20 + 'px',
			//#endif
			imgHost: HTTP_REQUEST_URL,
			videoID: 0,
			pinlunNum: 0,
			windowWidth: 0,
			windowHeight: 0,
			platform: '',
			deleteHeight: 0,
			dataList: [],
			shareItem: null,
			k: 0,
			max: 2,
			oldVideo: '',
			voice: '',
			timeout: '',
			authorUid: 0,
			current: 0,
			// å¼•å…¥è¯„è®º - å‚æ•°
			heightNum: 1.3,
			// åŒå‡»ç‚¹èµå‚æ•°
			touchNum: 0,
			aixinLeft: 0,
			aixinTop: 0,
			Rotate: 0,
			currentNav: 1,
			limit: 6,
			page: 1,
			oldCurrent: 1,
			H5ShareBox: false,
			showComment: false,
			loadVideo: true,
			loadend: false,
			userInfo: {},
			moreList: [],
			posters: false,
			weixinStatus: false,
			showManage: false,
			isUser: false,
			isSatrt: 0,
			userUid: 0,
			posterImageStatus: false,
			storeImage: '', //æµ·æŠ¥äº§å“å›¾
			PromotionCode: '', //äºŒç»´ç å›¾ç‰‡
			canvasStatus: false, //æµ·æŠ¥ç»˜å›¾æ ‡ç­¾
			posterImage: '', //æµ·æŠ¥è·¯å¾„
			posterbackgd: '../static/img/index/posterbackgd.png',
			avatar: HTTP_REQUEST_URL+'/static/images/f.png',
			codeImg: '',
			autoplay: false,
			circular: true,
			interval: 3000,
			duration: 500,
			actionSheetHidden: false,
			isLoadingIndex: 0,
			buffered: 0, // åŠ è½½è¿›åº¦
			// #ifdef MP
			isRoutine: true,
			// #endif
			// #ifndef MP
			isRoutine: true
			// #endif
		};
	},
	watch: {
		k(new_k, old_k) {
			const max = new_k + 2;
			if (this.max < max) {
				this.max = max;
			}
			this.dataList[old_k].playIng = false; //å¦‚æœè§†é¢‘æš‚åœï¼Œå°±åŠ è½½å°é¢
			this.dataList[old_k].isplay = true;
			this.dataList[old_k].state = 'pause';
			// 2.0ç‰ˆæœ¬å·²ç»å»æ‰äº†ä¸‹é¢è¿™ä¸€å¥ï¼Œè§†é¢‘ä¸ç”¨æš‚åœï¼Œåªéœ€è¦æŠŠå£°éŸ³ç¦æ­¢å°±è¡Œ
			uni.createVideoContext(this.dataList[old_k].community_id + '' + old_k, this).pause(); //å¦‚æœè§†é¢‘æš‚åœï¼Œé‚£ä¹ˆæ—§è§†é¢‘åœæ­¢ï¼Œè¿™é‡Œçš„this.dataList[old_k].id + '' + old_kï¼Œåé¢åŠ  old_k æ˜¯ä¸ºäº†æ¯ä¸€ä¸ªè§†é¢‘çš„ id å€¼ä¸åŒï¼Œè¿™æ ·å°±å¯ä»¥å¤§ç¨‹åº¦çš„é¿å…ä¸²éŸ³é—®é¢˜

			this.dataList[new_k].state = 'play';
			this.dataList[new_k].isplay = false;
			this.dataList[new_k].playIng = true;
			this.$nextTick(() => {
				uni.createVideoContext(this.dataList[new_k].community_id + '' + new_k, this).play()
			})
			// #ifdef MP
			this.videoShare(this.dataList[new_k]);
			// #endif
		}
	},
	onLoad(options) {
		// #ifdef WEB
		if (this.$wechat.isWeixin()) {
			document.addEventListener("WeixinJSBridgeReady", () => {
				uni.createVideoContext(this.dataList[this.k].community_id + '' + this.k, this).play()
			}, false);
		}
		// #endif
		this.getOptions(options);
		this.videoID = options.id;
		this.isUser = options.user == 1 ? true : false;
		this.userUid = options.uid ? options.uid : 0;
		this.isSatrt = options.tab == 1 ? 1 : 0;
		this.get(); //åˆšè¿›å…¥é¡µé¢åŠ è½½æ•°æ®
		this.downloadFilePromotionCode(this.videoID);
		if (this.isLogin) {
			this.getUserInfo();
		}


		// #ifdef H5
		this.setOpenShare();
		// #endif
	},
	onShow() {},
	onHide() {
		this.dataList[this.k].state = 'pause'; //ç•Œé¢éšè—ä¹Ÿè¦åœæ­¢æ’­æ”¾è§†é¢‘
		uni.createVideoContext(this.dataList[this.k].community_id + '' + this.k, this).pause(); //æš‚åœä»¥åç»§ç»­æ’­æ”¾
	},
	onReady: function () {
		this.windowWidth = uni.getSystemInfoSync().windowWidth;
		this.windowHeight = uni.getSystemInfoSync().windowHeight;
	},
	//å‘é€ç»™æœ‹å‹
	onShareAppMessage(res) {
		let uid = this.uid ? this.uid : 0;
		return {
			title: this.shareItem.title || '',
			path: '/pages/short_video/nvueSwiper/index?id=' + this.shareItem.community_id + '&pid=' + uid,
			imageUrl: this.shareItem.image[0] || '' //åˆ†äº«å›¾æ ‡ï¼Œè·¯å¾„å¯ä»¥æ˜¯æœ¬åœ°æ–‡ä»¶è·¯å¾„ã€ä»£ç åŒ…æ–‡ä»¶è·¯å¾„æˆ–è€…ç½‘ç»œå›¾ç‰‡è·¯å¾„.æ”¯æŒPNGåŠJPGã€‚æ˜¾ç¤ºå›¾ç‰‡é•¿å®½æ¯”æ˜¯ 5:4
		};
	},
	//åˆ†äº«åˆ°æœ‹å‹åœˆ
	onShareTimeline(res) {
		return {
			title: this.shareItem.title || '',
			query: {
				id: this.shareItem.community_id,
				pid: this.uid
			}, //é¡µé¢å‚æ•°
			imageUrl: this.shareItem.image[0] || '' //åˆ†äº«å›¾æ ‡ï¼Œè·¯å¾„å¯ä»¥æ˜¯æœ¬åœ°æ–‡ä»¶è·¯å¾„ã€ä»£ç åŒ…æ–‡ä»¶è·¯å¾„æˆ–è€…ç½‘ç»œå›¾ç‰‡è·¯å¾„.æ”¯æŒPNGåŠJPGã€‚æ˜¾ç¤ºå›¾ç‰‡é•¿å®½æ¯”æ˜¯ 5:4
		};
	},
	methods: {
		handleMuteBtnClick() {
			this.isMuted = false;
		},
		getMuteDefaultVal() {
			// #ifdef MP
			return false;
			// #endif
			return getCurrentPages().length === 0;
		},
		//#ifdef MP
		videoShare(item) {
			this.shareItem = item;
			if (item && item.status == 1) {
				uni.showShareMenu({
					withShareTicket: true,
					menus: ['shareAppMessage', 'shareTimeline']
				});
			} else {
				uni.hideShareMenu();
			}
		},
		// #endif
		goBack: function () {
			uni.navigateBack();
		},
		navTap(n) {
			this.currentNav = n;
			this.dataList.forEach((item) => {
				item.state = 'pause';
			});
			this.k = 0;
			this.page = 1;
			this.loadVideo = true;
			this.loadend = false;
			this.dataList = [];
			n == 1 ? this.get() : this.getFocusList();
		},
		/**
		 * è·å–ä¸ªäººç”¨æˆ·ä¿¡æ¯
		 */
		getUserInfo: function () {
			let that = this;
			getUserInfo().then((res) => {
				that.userInfo = res.data;
			});
		},
		// å…³æ³¨ä½œè€…
		followAuthor: function (item) {
			if (this.isLogin === false) {
				toLogin();
			} else {
				let status = 1;
				followAuthorApi(item.uid, { status: status })
					.then((res) => {
						if (res.status === 200) {
							item.is_fans = true;
						}
						this.$util.Tips({
							title: res.message
						});
					})
					.catch((err) => {
						return uni.showToast({
							title: err,
							icon: 'none',
							duration: 2000
						});
					});
			}
		},
		// åˆ é™¤è¯é¢˜
		deleteTopic(item) {
			let that = this;
			uni.showModal({
				content: 'ç¡®å®šè¦åˆ é™¤è¯¥è¯é¢˜ä¹ˆï¼Ÿ',
				success: function (res) {
					if (res.confirm) {
						deletePlantApi(item.community_id).then((res) => {
							if (res.status === 200) {
								that.$util.Tips({
									title: res.message
								});
								setTimeout(function () {
									uni.redirectTo({
										url: '/pages/plantGrass/plant_user/index?id=' + item.uid
									});
								}, 1000);
							}
						});
					} else if (res.cancel) {
						console.log('ç”¨æˆ·ç‚¹å‡»å–æ¶ˆ');
					}
				}
			});
		},
		play(k) {
			this.dataList[k].isplay = false;
			this.dataList[k].playIng = true;
			this.dataList[k].state = 'play';
			this.dataList[k].loading = false;
		},
		// è¿›å…¥åŠ è½½çŠ¶æ€
		waiting(k) {
			if (this.buffered < 100) {
				uni.showLoading({
					title: 'åŠªåŠ›åŠ è½½ä¸­',
					mask: false
				});
				this.isLoadingIndex = 0;
			}
		},
		// åŠ è½½ç™¾åˆ†æ¯”
		onprogress(e) {
			this.buffered = e.detail.buffered;
		},
		// æ’­æ”¾è¿›åº¦å˜åŒ–æ—¶è§¦å‘
		ontimeupdate(k, e) {
			this.isLoadingIndex += 1;
			if (this.isLoadingIndex > 1) uni.hideLoading();
		},
		pinlunFun(e) {
			this.pinlunNum = e;
			this.dataList.forEach((item) => {
				if (item.community_id == this.videoID) {
					item.count_reply = item.count_reply + 1;
				}
			});
		},
		getOptions(options) {
			let that = this;
			// #ifdef MP
			if (options.scene) {
				let value = that.$util.getUrlParams(decodeURIComponent(options.scene));
				//è®°å½•æ¨å¹¿äººuid
				if (value.pid) app.globalData.spid = value.pid;
			}
			// #endif
			if (options.pid) app.globalData.spid = options.pid;
		},
		// #ifdef H5
		// å¾®ä¿¡åˆ†äº«ï¼›
		setOpenShare: function () {
			let that = this;
			let uid = this.uid ? this.uid : 0;
			if (that.$wechat.isWeixin()) {
				let data = this.dataList[0];
				let configAppMessage = {
					desc: data.content,
					title: data.title,
					link: location.href + '?pid=' + uid + '&id=' + this.videoID,
					imgUrl: data.image
				};
				that.$wechat.wechatEvevt(['updateAppMessageShareData', 'updateTimelineShareData', 'onMenuShareAppMessage', 'onMenuShareTimeline'], configAppMessage);
			}
		},
		// #endif
		moreTap(item) {
			item.isMore = !item.isMore;
		},
		moveHandle() {},
		closeScrollview() {
			// ç‚¹å‡»è¯„è®ºé‡Œé¢çš„å‰å‰ï¼Œå°±ä¼šå…³é—­è¯„è®º
			this.showComment = false;
		},
		toComment(item, index) {
			// æ³¨æ„ç‚¹å‡»è¯„è®ºä¹‹åä¼šæ‰§è¡Œè¿™é‡Œ
			/*
				ï¼ˆ1ï¼‰å…ˆåŠ è½½ç¼“å†²
				ï¼ˆ2ï¼‰è·å–å½“å‰è§†é¢‘ ID ä¿¡æ¯
				ï¼ˆ3ï¼‰ğŸŒŸğŸŒŸğŸŒŸğŸŒŸé‡è¦ğŸŒŸğŸŒŸğŸŒŸğŸŒŸ
					- ä¸€å®šè¦è®°å¾—çœ‹ index.vue é‡Œé¢
					 uni.setStorageSync("user",this.peopleList[i]);
					 è¿™ä¸ªä¸œè¥¿ï¼Œç”¨äºå­˜å‚¨å½“å‰ç”¨æˆ·ä¿¡æ¯ã€‚åœ¨ æ’ä»¶é‡Œé¢ä¼šä½¿ç”¨åˆ°è¿™ä¸ªä¸œè¥¿ï¼Œ
					 è®°å¾—å†™ä¸€ä¸‹ã€‚

				ï¼ˆ4ï¼‰æ‰“å¼€è¯„è®º
				*/
			this.showComment = true;
			this.$refs.comments.getData(item, index);
		},
		ended() {
			// 1.æ’­æ”¾å½“å‰è§†é¢‘ç»“æŸæ—¶è§¦å‘ï¼Œè‡ªåŠ¨åˆ‡æ¢ä¸‹ä¸€ä¸ªè§†é¢‘
			// this.current = this.k+1
		},
		//ç‚¹å‡»æ’­æ”¾&&æš‚åœ
		tapVideoHover(state, event) {
			// 1.å¯ç”¨åŒå‡»ç‚¹èµ --- start
			this.touchNum++;
			setTimeout(() => {
				if (this.touchNum == 1) {
					if (state == 'play' || state == 'continue') {
						// this.dataList[this.k].state = 'pause';
						this.$set(this.dataList[this.k], 'state', 'pause');
					} else {
						// this.dataList[this.k].state = 'continue';
						this.$set(this.dataList[this.k], 'state', 'continue');
					}
					if (this.dataList[this.k].state == 'continue') {
						uni.createVideoContext(this.dataList[this.k].community_id + '' + this.k, this).play(); //æš‚åœä»¥åç»§ç»­æ’­æ”¾
					}
					if (this.dataList[this.k].state == 'pause') {
						uni.createVideoContext(this.dataList[this.k].community_id + '' + this.k, this).pause(); //æš‚åœä»¥åç»§ç»­æ’­æ”¾
					}
				}
				this.touchNum = 0;
			}, 200);
		},
		change(event) {
			this.k = event.detail.current;
			this.posterImage = false;
			if (this.isLogin && this.dataList[this.k]) {
				this.downloadFilePromotionCode(this.dataList[this.k]['community_id']);
			}
		},
		animationfinish(event) {
			// 1.è¿™é‡Œè¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœæ˜¯æœ€åä¸€ä¸ªè§†é¢‘å°±è¿›å…¥ get() æ–¹æ³•åŠ è½½è§†é¢‘è¿›å…¥åˆ—è¡¨
			if (this.k == this.dataList.length - 1) {
				this.loadVideo = true;
				this.currentNav == 1 ? this.GET() : this.getFocusList();
			}
		},
		//æ¯ä¸€ç»„ç»“æŸæ—¶æ–°çš„è¯·æ±‚
		GET() {
			let that = this;
			if (!that.loadVideo) return;
			if (that.loadend) return;
			that.loadVideo = true;
			that.isUser
				? myVideoList(that.userUid, {
						page: that.page,
						limit: that.limit,
						is_star: that.isSatrt,
						community_id: that.videoID
				  })
						.then((res) => {
							that.videoData(res.data.list);
							that.loadVideo = false;
							that.loadend = res.data.list.length < that.limit;
						})
						.catch((err) => {
							return uni.showToast({
								title: err,
								icon: 'none',
								duration: 2000
							});
						})
				: videoList({
						page: that.page,
						limit: that.limit,
						id: that.videoID
				  })
						.then((res) => {
							that.loadVideo = false;
							that.videoData(res.data.list);
							that.loadend = res.data.list.length < that.limit;
						})
						.catch((err) => {
							return uni.showToast({
								title: err,
								icon: 'none',
								duration: 2000
							});
						});
		},
		get() {
			let that = this;
			// 1.è¿™é‡Œå¼•å…¥åç«¯è¯·æ±‚æ•°æ®
			that.isUser
				? myVideoList(that.userUid, {
						page: that.page,
						limit: that.limit,
						is_star: that.isSatrt,
						community_id: that.videoID
				  })
						.then((res) => {
							that.page = that.page + 1;
							that.videoData(res.data.list);
						})
						.catch((err) => {
							return uni.showToast({
								title: err,
								icon: 'none',
								duration: 2000
							});
						})
				: videoList({
						page: that.page,
						limit: that.limit,
						id: that.videoID
				  })
						.then((res) => {
							that.page = that.page + 1;
							that.videoData(res.data.list);
						})
						.catch((err) => {
							return uni.showToast({
								title: err,
								icon: 'none',
								duration: 2000
							});
						});
		},
		getFocusList() {
			let that = this;
			if (!that.loadVideo) return;
			if (that.loadend) return;
			that.loadVideo = true;
			focusArticleLst({
				page: that.page,
				limit: that.limit
			})
				.then((res) => {
					that.loadVideo = false;
					that.loadend = res.data.list.length < that.limit;
					that.page = that.page + 1;
					that.videoData(res.data.list);
				})
				.catch((err) => {
					return uni.showToast({
						title: err,
						icon: 'none',
						duration: 2000
					});
				});
		},
		videoData(list) {
			if (list.length == 0) return;
			let that = this;
			var msg = list;
			// 2.è¿™é‡ŒæŠŠè§†é¢‘æ·»åŠ åˆ°è§†é¢‘åˆ—è¡¨
			for (let i = 0; i < msg.length; i++) {
				msg[i]['isMore'] = false;
				msg[i]['playIng'] = false;
				msg[i]['state'] = 'pause';
				msg[i]['isplay'] = true;
				msg[i]['loading'] = false;
				that.dataList.push(msg[i]);
				if (i == 0) {
					that.dataList[0].isplay = false;
					that.dataList[0].playIng = true;
					that.dataList[0].state = 'play';
					that.dataList[0].loading = false;
					setTimeout(() => {
						uni.createVideoContext(that.dataList[0].community_id + '' + 0, that).play()
					}, 250)
				}
			}
			//#ifdef MP
			if (this.k == 0) {
				this.videoShare(this.dataList[0]);
			}
			// #endif
			// #ifdef H5
			if (that.isLogin) {
				that.setOpenShare(that.videoID);
			}
			// #endif
		},
		share() {
			this.H5ShareBox = true;
		},
		/**
		 * åˆ†äº«æ‰“å¼€
		 *
		 */
		listenerActionSheet: function () {
			// #ifdef H5
			if (this.$wechat.isWeixin() === true) {
				this.weixinStatus = true;
			}
			// #endif
			this.posters = true;
		},
		// åˆ†äº«å…³é—­
		listenerActionClose: function () {
			this.posters = false;
		},
		//éšè—æµ·æŠ¥
		posterImageClose: function () {
			this.posterImageStatus = false;
		},
		// å°ç¨‹åºå…³é—­åˆ†äº«å¼¹çª—ï¼›
		goFriend: function () {
			this.posters = false;
		},
		/* è·å–äº§å“åˆ†é”€äºŒç»´ç 
		 * @param function successFn ä¸‹è½½å®Œæˆå›è°ƒ
		 *
		 */
		downloadFilePromotionCode: function (id) {
			let that = this;
			let type;
			// #ifndef MP
			type = 'wechat';
			// #endif
			// #ifdef MP
			type = 'routine';
			// #endif
			getVideoCode(id, {
				type: type
			})
				.then(async (res) => {
					that.codeImg = res.data.url;
				})
				.catch((err) => {
					that.$set(that, 'PromotionCode', '');
				});
		},
		/*
		 * ä¿å­˜åˆ°æ‰‹æœºç›¸å†Œ
		 */
		// #ifdef MP
		savePosterPath: function () {
			let that = this;
			uni.getSetting({
				success(res) {
					if (!res.authSetting['scope.writePhotosAlbum']) {
						uni.authorize({
							scope: 'scope.writePhotosAlbum',
							success() {
								uni.saveImageToPhotosAlbum({
									filePath: that.posterImage,
									success: function (res) {
										that.posterImageClose();
										that.$util.Tips({
											title: 'ä¿å­˜æˆåŠŸ',
											icon: 'success'
										});
									},
									fail: function (res) {
										that.$util.Tips({
											title: 'ä¿å­˜å¤±è´¥'
										});
									}
								});
							}
						});
					} else {
						uni.saveImageToPhotosAlbum({
							filePath: that.posterImage,
							success: function (res) {
								that.posterImageClose();
								that.$util.Tips({
									title: 'ä¿å­˜æˆåŠŸ',
									icon: 'success'
								});
							},
							fail: function (res) {
								that.$util.Tips({
									title: 'ä¿å­˜å¤±è´¥'
								});
							}
						});
					}
				}
			});
		},
		// #endif
		/**
		 * ç”Ÿæˆæµ·æŠ¥
		 */
		async goPoster() {
			if (this.posterImage) {
				this.posterImageStatus = true;
				this.posters = false;
				return;
			}
			let that = this;
			let arr2;
			that.posters = false;
			that.$set(that, 'canvasStatus', true);
			uni.showLoading({
				title: 'æµ·æŠ¥ç”Ÿæˆä¸­',
				mask: true
			});
			// #ifdef MP || APP-PLUS
			if (that.dataList[that.k].author.avatar) {
				arr2 = [
					that.posterbackgd,
					await that.fileStoreImage(that.dataList[that.k].image[0]),
					await that.fileStoreImage(that.codeImg),
					await that.fileStoreImage(that.dataList[that.k].author.avatar)
				];
			} else {
				arr2 = [that.posterbackgd, await that.fileStoreImage(that.dataList[that.k].image[0]), await that.fileStoreImage(that.codeImg), that.avatar];
			}
			// #endif
			// #ifdef H5
			if (that.dataList[that.k].author.avatar) {
				arr2 = [
					that.posterbackgd,
					await that.imgToBase(that.dataList[that.k].image[0]),
					await that.imgToBase(that.codeImg),
					await that.imgToBase(that.dataList[that.k].author.avatar)
				];
			} else {
				arr2 = [that.posterbackgd, await that.imgToBase(that.dataList[that.k].image[0]), await that.imgToBase(that.codeImg), that.avatar];
			}
			// #endif
			//ç”Ÿæˆæ¨å¹¿æµ·æŠ¥
			that.$util.videoPosterCanvas(
				arr2,
				that.dataList[that.k].content,
				that.dataList[that.k].author.nickname,
				function (tempFilePath) {
					that.$set(that, 'posterImage', tempFilePath);
					that.$set(that, 'posterImageStatus', true);
					that.$set(that, 'actionSheetHidden', !that.actionSheetHidden);
					that.$set(that, 'canvasStatus', false);
				},
				(err) => {
					that.$set(that, 'canvasStatus', false);
				}
			);
		},
		//å›¾ç‰‡è½¬ç¬¦åˆå®‰å…¨åŸŸåè·¯å¾„
		fileStoreImage(url) {
			let that = this;
			// #ifdef MP  || APP-PLUS
			let ishttps = url.split('//')[0] == 'https:';
			if (!ishttps) {
				url = 'https://' + url.split('//')[1];
			}
			// #endif
			return new Promise((resolve, reject) => {
				uni.downloadFile({
					url: url,
					success: function (res) {
						resolve(res.tempFilePath);
					},
					fail: function () {
						return that.$util.Tips({
							title: ''
						});
					}
				});
			});
		},
		/*
		 * ä¿å­˜åˆ°æ‰‹æœºç›¸å†Œ
		 */
		// #ifdef MP
		savePosterPath: function () {
			let that = this;
			uni.getSetting({
				success(res) {
					if (!res.authSetting['scope.writePhotosAlbum']) {
						uni.authorize({
							scope: 'scope.writePhotosAlbum',
							success() {
								uni.saveImageToPhotosAlbum({
									filePath: that.posterImage,
									success: function (res) {
										that.posterImageClose();
										that.$util.Tips({
											title: 'ä¿å­˜æˆåŠŸ',
											icon: 'success'
										});
									},
									fail: function (res) {
										that.$util.Tips({
											title: 'ä¿å­˜å¤±è´¥'
										});
									}
								});
							}
						});
					} else {
						uni.saveImageToPhotosAlbum({
							filePath: that.posterImage,
							success: function (res) {
								that.posterImageClose();
								that.$util.Tips({
									title: 'ä¿å­˜æˆåŠŸ',
									icon: 'success'
								});
							},
							fail: function (res) {
								that.$util.Tips({
									title: 'ä¿å­˜å¤±è´¥'
								});
							}
						});
					}
				}
			});
		},
		// #endif
		async imgToBase(url) {
			let res = await imgToBase({
				image: url
			});
			return res.data.image;
		},
		cLike(item) {
			if (this.isLogin) {
				let status = item.relevance_id ? 0 : 1;
				graphicStartApi(item.community_id, { status: status })
					.then((res) => {
						if (item.relevance_id) {
							item.count_start--;
							item.count_start = item.count_start == 0 ? 0 : item.count_start;
							item.relevance_id = false;
						} else {
							item.count_start++;
							item.relevance_id = true;
						}
					})
					.catch((err) => {
						return uni.showToast({
							title: err,
							icon: 'none',
							duration: 2000
						});
					});
			} else {
				toLogin();
			}
		},
		/*æŸ¥çœ‹æåˆ°çš„å®è´*/
		openMore(item) {
			this.$refs.mentioned.showPopup();
			this.moreList = item.relevance;
			this.authorUid = item.uid;
		},
		closePopup() {
			this.$refs.mentioned.closePopup();
		},
		goDetail(item) {
			if (item.product_type === 1) {
				uni.navigateTo({
					url: `/pages/activity/goods_seckill_details/index?id=${item.product_id}&time=${item.stop_time}&spid=${this.uid}`
				});
			} else if (item.product_type === 2) {
				uni.navigateTo({
					url: `/pages/activity/presell_details/index?id=${item.activity_id}&spid=${this.uid}`
				});
			} else if (item.product_type === 0) {
				uni.navigateTo({
					url: `/pages/goods_details/index?id=${item.product_id}&spid=${this.uid}`
				});
			} else if (item.product_type === 4) {
				uni.navigateTo({
					url: `/pages/activity/combination_details/index?id=${item.activity_id}&spid=${this.uid}`
				});
			} else if (item.product_type === 40) {
				uni.navigateTo({
					url: `/pages/activity/combination_status/index?id=${item.activity_id}&spid=${this.uid}`
				});
			}
		}
	}
};
</script>

<style lang="scss" scoped>
.header {
	position: fixed;
	z-index: 9;
	width: 750rpx;
	height: 86rpx;
	flex-direction: row;
	justify-content: center;
	align-items: center;
	top: 20rpx;
	.tool-bar {
		position: absolute;
		left: 0;
		top: 0;
		width: 60rpx;
		height: 86rpx;
		display: flex;
		justify-content: center;
		.icon-ic_leftarrow {
			margin-right: 40rpx;
			margin-left: 20rpx;
			font-size: 30rpx;
			color: #fff;
		}
	}
	.items {
		margin: 0 30rpx;
		.tName {
			color: #ffffff;
			font-size: 32rpx;
			&.on {
				font-size: 38rpx;
			}
		}
	}
}
.shareImg {
	z-index: 1000;
	position: fixed;
	left: 0;
	top: 0;
	width: 100%;
	height: 100%;
}
.shortVideo,
.container {
	background: linear-gradient(180deg, rgba(0, 0, 0, 0.8) 0%, #000000 100%);
}
.item {
	position: relative;
}
.video-status {
	width: 690rpx;
	position: absolute;
	left: 30rpx;
	background: rgba(0, 0, 0, 0.55);
	border-radius: 16rpx;
	top: 60rpx;
	padding: 30rpx;
	.status-title {
		flex-direction: row;
		align-items: center;
		.title {
			margin-left: 20rpx;
			color: #ffffff;
			font-size: 28rpx;
		}
	}
	.refusal {
		color: #ffffff;
		font-size: 22rpx;
		margin: 15rpx 0 0 48rpx;
	}
	.image {
		width: 28rpx;
		height: 28rpx;
	}
}
.videoHover {
	position: absolute;
	top: 0;
	left: 0;
	flex: 1;
	justify-content: center;
	align-items: center;
}
.playState {
	width: 160rpx;
	height: 160rpx;
	opacity: 0.2;
}
.userInfo {
	position: absolute;
	bottom: 60rpx;
	right: 20rpx;
	flex-direction: column;
	// align-items: flex-end;
	text-align: center;
	.pictrue {
		flex-direction: column;
		justify-content: center;
		align-items: center;
		position: relative;
		image {
			width: 92rpx;
			height: 92rpx;
		}
		.guanzhu {
			width: 42rpx;
			height: 42rpx;
			display: flex;
			align-items: center;
			justify-content: center;
			color: #fff;
			background: #e93323;
			border-radius: 100%;
			position: relative;
			top: -20rpx;
			left: 26rpx;
			.iconfont {
				font-size: 20rpx;
			}
		}
		.yiguanzhu {
			width: 42rpx;
			height: 42rpx;
		}
	}
	.mention {
		width: 92rpx;
		height: 92rpx;
		position: relative;
		image {
			width: 58rpx;
			height: 58rpx;
			position: absolute;
			right: 16rpx;
		}
		.count {
			width: 30rpx;
			height: 30rpx;
			line-height: 30rpx;
			background: #fff;
			border-radius: 100%;
			display: flex;
			align-items: center;
			justify-content: center;
			color: #e93323;
			position: absolute;
			right: 8rpx;
			top: -12rpx;
			font-size: 20rpx;
		}
	}
	.iconfont {
		color: #ffffff;
		&.likeNumActive {
			color: #e93323;
		}
	}
}
.icon-ic_love_2 {
	font-size: 64rpx;
}
.icon-icon_comment {
	font-size: 59rpx;
}
.icon-icon_transmit {
	font-size: 58rpx;
}
.info-text {
	margin-top: 10rpx;
	color: #ffffff;
}
.userAvatar {
	border-radius: 500%;
	border-style: solid;
	border-width: 2px;
	border-color: #ffffff;
	width: 80rpx;
	height: 80rpx;
	display: block;
}
.video-dian {
	position: relative;
	width: 66rpx;
	height: 66rpx;
	align-items: center;
	justify-content: center;
	flex-direction: row;
	// left: 12rpx;
	.dian {
		width: 13rpx;
		height: 13rpx;
		background-color: #fff;
		border-radius: 100%;
		margin-right: 10rpx;
		&:last-child {
			margin-right: 0;
		}
	}
}
.manage {
	width: 210rpx;
	background: #ffffff;
	box-shadow: 0 2rpx 15rpx rgba(0, 0, 0, 0.1);
	padding: 0 15rpx;
	position: absolute;
	bottom: -50rpx;
	right: 110rpx;
	z-index: 90;
	border-radius: 16rpx;
	&::before {
		content: '';
		display: inline-block;
		width: 26rpx;
		height: 26rpx;
		background: #ffffff;
		transform: rotate(140deg);
		position: absolute;
		top: 60rpx;
		right: -12rpx;
		box-shadow: -1rpx -1rpx 1rpx rgba(0, 0, 0, 0.05);
	}
	.items {
		border-bottom: 1px solid #eeeeee;
		color: #282828;
		font-size: 26rpx;
		padding: 20rpx 0;
		display: flex;
		align-items: center;
		flex-direction: row;
		&:last-child {
			border-bottom: none;
		}
		.image {
			width: 32rpx;
			height: 32rpx;
			margin: 0 16rpx 0;
		}
	}
}
.likeNumActive {
	color: #e93323;
}
.content {
	width: 590rpx;
	position: absolute;
	bottom: 30rpx;
	bottom: calc(30rpx+ constant(safe-area-inset-bottom)); ///å…¼å®¹ IOS<11.2/
	bottom: calc(30rpx + env(safe-area-inset-bottom)); ///å…¼å®¹ IOS>11.2/
	padding: 15rpx 0;
	flex-direction: column;
	justify-content: flex-start;
	color: #ffffff;
	left: 50%;
	margin-left: -345rpx;
	.time {
		font-size: 24rpx;
		color: rgba(255, 255, 255, 0.5);
		margin-left: 12rpx;
	}
	.cart {
		height: 48rpx;
		flex-direction: row;
		.cartName {
			font-size: 24rpx;
			color: #fff;
		}
	}
}
.canvas {
	z-index: 300;
	width: 750px;
	height: 1036px;
}
.poster-pop {
	width: 600rpx;
	/*#ifdef H5*/
	height: 820rpx;
	/*#endif*/
	/*#ifndef H5*/
	height: 910rpx;
	/*#endif*/
	position: fixed;
	left: 50%;
	transform: translateX(-50%);
	z-index: 399;
	top: 50%;
	margin-top: -410rpx;
	border-radius: 30rpx;
}
.poster-pop .image {
	border-radius: 16rpx;
}
.poster-pop .keep {
	text-align: center;
	width: 600rpx;
	height: 70rpx;
	line-height: 70rpx;
	border-radius: 43rpx;
	background: #e93323;
	color: #ffffff;
	font-size: 25rpx;
	margin-top: 40rpx;
}
.mask {
	position: fixed;
	top: 0;
	left: 0;
	right: 0;
	bottom: 0;
	background-color: rgba(0, 0, 0, 0.6);
	z-index: 9;
}
.words {
	margin-top: 12rpx;
	.close {
		display: flex;
		flex-direction: row;
		align-items: center;
		justify-content: flex-end;
		margin-right: 20rpx;
		.imgClose {
			width: 18rpx;
			height: 10rpx;
			margin-left: 10rpx;
		}
	}
	.wordsCon {
		position: relative;
		.more {
			position: absolute;
			bottom: 0;
			right: 40rpx;
			font-size: 26rpx;
		}
		.img {
			width: 18rpx;
			height: 10rpx;
			margin-left: 4rpx;
			position: absolute;
			bottom: 7rpx;
			right: 15rpx;
		}
	}
	.info {
		color: #fff;
		font-size: 28rpx;
	}
	.more {
		font-size: 26rpx;
		color: #ffffff;
		font-weight: 400;
	}
}
.product {
	display: block;
	margin-top: 27rpx;
	.product-item {
		display: inline-block;
		width: 444rpx;
		height: 136rpx;
		background: rgba(0, 0, 0, 0.55);
		border-radius: 12rpx;
		padding: 16rpx 15rpx;
		margin-right: 30rpx;
	}
	/deep/uni-swiper,
	/deep/swiper {
		display: block;
		height: 136rpx !important;
		.swiper-count {
			display: block;
			width: 444rpx !important;
			height: 136rpx !important;
			background: rgba(0, 0, 0, 0.55);
			border-radius: 12rpx;
			padding: 16rpx 15rpx 16rpx 15rpx;
		}
		.swiper-item {
			display: block;
			width: 480rpx !important;
		}
	}
	.item-count {
		width: 414rpx;
		flex-direction: row;
		justify-content: space-between;
		border-radius: 12rpx;
		.picture {
			width: 104rpx;
			height: 104rpx;
			border-radius: 10rpx;
			image {
				width: 104rpx;
				height: 104rpx;
				border-radius: 10rpx;
			}
		}
		.product-text {
			width: 266rpx;
			justify-content: space-between;
			.name {
				display: inline-block;
				width: 266rpx;
			}
			.product-price {
				display: flex;
				flex-direction: row;
				justify-content: space-between;
				align-items: center;
				.price {
					display: flex;
					flex-direction: row;
					align-items: flex-end;
					text {
						font-size: 34rpx;
					}
				}
				.buy-btn {
					width: 92rpx;
					height: 40rpx;
					display: flex;
					align-items: center;
					justify-content: center;
					color: #fff;
					border-radius: 26rpx;
					background: #e93323;
					font-size: 20rpx;
				}
			}
		}
	}
}
.product_cate {
	margin: 20rpx 0;
	flex-direction: row;
	> view {
		display: inline-block;
		flex-direction: row;
		align-items: center;
		border-radius: 30rpx;
		padding: 0 24rpx;
		line-height: 40rpx;
		border-radius: 29rpx;
		border: 1px solid #ffffff;
		.text {
			font-size: 24rpx;
		}
		.icon {
			display: inline-block;
			font-size: 26rpx;
			font-weight: bold;
			position: relative;
			top: 2rpx;
			margin-right: 8rpx;
		}
	}
}
.generate-posters {
	width: 100%;
	height: 170rpx;
	background-color: #fff;
	position: fixed;
	left: 0;
	bottom: 0;
	z-index: 388;
	transform: translate3d(0, 100%, 0);
	transition: all 0.3s cubic-bezier(0.25, 0.5, 0.5, 0.9);
	border-radius: 40rpx 40rpx 0 0;
	align-content: center;
	align-items: center;
	flex-direction: row;
}
.generate-posters.on {
	transform: translate3d(0, 0, 0);
}
.generate-posters .item {
	/* #ifdef H5 */
	flex: 100%;
	/* #endif */
	/* #ifndef H5 */
	flex: 33.33%;
	/* #endif */
	text-align: center;
	font-size: 30rpx;
	&.item3 {
		flex: 33.33%;
	}
}
.generate-posters .item .iconfont {
	font-size: 36rpx;
	background-color: #5eae72;
	width: 70rpx;
	height: 70rpx;
	border-radius: 100%;
	color: #ffffff;
	display: inline-block;
	line-height: 70rpx;
	margin-bottom: 8rpx;
}
.generate-posters .item .iconfont.icon-a-ic_picture1 {
	background-color: #5391f1;
}
.mask {
	position: fixed;
	top: 0;
	left: 0;
	right: 0;
	bottom: 0;
	background-color: rgba(0, 0, 0, 0.6);
	z-index: 9;
}
.noVideo {
	position: fixed;
	top: 400rpx;
	z-index: 9;
	width: 750rpx;
	flex-direction: row;
	justify-content: center;
	.pictrue {
		width: 414rpx;
		height: 256rpx;
	}
	.tips {
		text-align: center;
		margin-top: 14rpx;
		font-size: 26rpx;
		color: #999;
	}
}

.mute-btn-box {
	margin-top: 17px;
	width: 45px;
	height: 45px;
	position: relative;
	&.hide {
		transition: all 0.3s ease-in-out;
		opacity: 0;
		height: 0;
	}

	@keyframes shrink {
		from {
			width: 100px;
		}

		to {
			width: 45px;
		}
	}

	@keyframes fade-in {
		from {
			opacity: 1;
		}
		to {
			opacity: 0;
		}
	}

	.mute-btn {
		--delay-time: 2s;

		background-color: white;
		width: 45px;
		height: 45px;
		border-radius: 45px;
		position: absolute;
		inset: 0 0 0 auto;

		&.animation {
			width: 100px;

			animation: shrink 0.3s ease-in-out forwards;
			animation-delay: var(--delay-time);

			.mute-text {
				opacity: 1;

				animation: fade-in 0.3s ease-in-out forwards;
				animation-delay: var(--delay-time);
			}
		}

		display: flex;
		flex-direction: row;
		align-items: center;
		padding: 0 10px;

		.mute-icon {
			width: 22px;
			height: 22px;
			flex-shrink: 0;
		}

		.mute-text {
			opacity: 0;
			font-size: 13px;
			margin-left: 5px;
			word-break: keep-all;
			user-select: none;
		}
	}
}
</style>
